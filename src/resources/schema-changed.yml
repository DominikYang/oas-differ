info:
  description: |
    Service Platform Public API
  license:
    name: Copyright Â© 2020 Trend Micro Incorporated. All rights reserved.
    url: 'https://www.trendmicro.com'
  title: Service Platform Public API
  version: 2.0.0
openapi: 3.0.1
servers:
  - url: 'https://api.xdr.trendmicro.com'
    description: US PROD server
  - url: 'https://api.eu.xdr.trendmicro.com'
    description: EU PROD server
  - url: 'https://api.sg.xdr.trendmicro.com'
    description: SG PROD server
  - url: 'https://api.xdr.trendmicro.co.jp'
    description: JP PROD server
components:
  schemas:
    SAEWorkbenchDetails:
      type: object
      properties:
        info:
          type: object
          description: |
            * 3002000: Get workbench details successfully.
          properties:
            code:
              description: code
              type: string
              example: 3002000
              enum:
                - 3002000
            msg:
              type: number
              example: Get workbench details successfully.
        data:
          type: object
          properties:
            workbenchId:
              type: string
              description: Workbench ID
              example: WB-9002-20200427-0002
            workbenchLink:
              type: string
              description: Workbench URL
              example: 'https://THE_WORKBENCH_URL'
            alertProvider:
              type: string
              description: null
              example: SAE
            model:
              type: string
              description: SAE alert model
              example: Possible APT Attack
            description:
              type: string
              description: Suspicious attack description
              example: Suspicious email followed by a possible backdoor implantation
            score:
              type: string
              description: Suspicious attack score
              example: '63'
            modelSeverity:
              type: string
              description: 'Could be low, medium, high or critical'
              example: critical
            impactScope:
              type: array
              description: The entity that was impacted
              items:
                type: object
                properties:
                  entityType:
                    type: string
                    description: 'Could be host, account or email address'
                    example: host
                  entityValue:
                    oneOf:
                      - type: string
                        example: loki@jaguartm.onmicrosoft.com
                      - type: object
                        properties:
                          name:
                            type: string
                            example: CODERED\\bonus-PC
                          ips:
                            type: array
                            items:
                              type: string
                              example: 10.110.2.1
                          guid:
                            type: string
                            example: 5257b401-2fd7-469c-94fa-39a4f11eb925
                    example:
                      name: CODERED\\bonus-PC
                      ips:
                        - 10.110.2.1
                        - 10.112.87.0
                      guid: 5257b401-2fd7-469c-94fa-39a4f11eb925
                  entityId:
                    type: string
                    example: 5257b401-2fd7-469c-94fa-39a4f11eb925
                  relatedEntities:
                    type: array
                    items:
                      type: string
                      example: CODERED\\loki
                  relatedIndicators:
                    type: array
                    items:
                      type: integer
                      example: 1
            indicators:
              type: array
              description: >-
                The indicators refer to those objects which are found by RCA or
                sweeping
              items:
                type: object
                properties:
                  id:
                    type: integer
                    example: 1
                  objectType:
                    type: string
                    example: url
                  objectValue:
                    type: string
                    example: 'http://www.DVftYKDtEi.com/ds7002.zip'
                  relatedEntities:
                    type: array
                    items:
                      type: string
                      example: loki@jaguartm.onmicrosoft.com
                  filterId:
                    type: array
                    items:
                      type: string
                      example: f862df72-7f5e-4b2b-9f7f-9148e875f908
            matchedRules:
              type: array
              description: The rules are triggered
              items:
                type: object
                properties:
                  id:
                    type: string
                    example: 5f52d1f1-53e7-411a-b74f-745ee81fa30b
                  name:
                    type: string
                    example: Possible SpearPhishing Email
                  matchedFilters:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          example: ccf86fc1-688f-4131-a46f-1d7a6ee2f88e
                        name:
                          type: string
                          example: (T1192) Spearphishing Link
                        timestamp:
                          type: string
                          example: '2019-08-02T04:00:01.000Z'
                        mitreTechniques:
                          type: array
                          items:
                            type: string
                            example: T1192
            alertTriggerTimestamp:
              type: string
              example: '2020-04-30T00:01:15.000Z'
            workbenchCompleteTimestamp:
              type: string
              example: '2030-04-30T00:01:16.000Z'
    TIWorkbenchDetails:
      type: object
      properties:
        info:
          type: object
          description: |
            * 3002000: Get workbench details successfully.
          properties:
            code:
              description: code
              type: integer
              example: 3002000
              enum:
                - 3002000
            msg:
              type: string
              example: Get workbench details successfully.
        data:
          type: object
          properties:
            schemaVersion:
              type: string
              description: Schema version
              example: '1.1'
            workbenchId:
              type: string
              description: Workbench ID
              example: WB-9002-20200427-0002
            workbenchLink:
              type: string
              description: Workbench URL
              example: >-
                https://portal-int.visionone.trendmicro.com/index.html#/workbench?workbenchId=WB-9002-20200427-0002
            alertProvider:
              type: string
              description: null
              example: TI
            model:
              type: string
              description: TI alert model
              example: >-
                Desktop, Mobile Phishing Campaign Targets South Korean Websites,
                Steals Credentials Via Watering Hole
            score:
              type: string
              description: Suspicious attack score
              example: 63
            campaign:
              type: string
              description: 'If this field has no value, it will show n/a here'
              example: Soula
            industry:
              type: string
              description: 'If this field has no value, it will show n/a here'
              example: n/a
            region/country:
              type: string
              description: 'If this field has no value, it will show n/a here'
              example: eastern-asia/Korea (the Republic of)
            modelSeverity:
              type: string
              description: 'Could be low, medium, high or critical'
              example: critical
            createdBy:
              type: string
              description: null
              example: Trend Micro Research
            totalIndicatorNumber:
              type: integer
              description: null
              example: 6
            matchedIndicatorNumber:
              type: integer
              description: null
              example: 2
            reportLink:
              type: string
              description: null
              example: 'https://THE_WORKBENCH_URL'
            impactScope:
              type: array
              description: The entity that was impacted
              items:
                type: object
                properties:
                  entityType:
                    type: string
                    description: It can only be a host now
                    example: host
                  entityValue:
                    type: object
                    properties:
                      name:
                        type: string
                        example: CODERED\\bonus-PC
                      ips:
                        type: array
                        items:
                          type: string
                          example: 10.110.2.1
                      guid:
                        type: string
                        example: 5257b401-2fd7-469c-94fa-39a4f11eb925
                    example:
                      name: CODERED\\bonus-PC
                      ips:
                        - 10.110.2.1
                        - 10.112.87.0
                      guid: 5257b401-2fd7-469c-94fa-39a4f11eb925
                  entityId:
                    type: string
                    example: 5257b401-2fd7-469c-94fa-39a4f11eb925
                  relatedEntities:
                    type: array
                    items:
                      type: string
                      example: 4257b401-2fd7-469c-94fa-39a4f11eb925
                  relatedIndicators:
                    type: array
                    items:
                      type: integer
                      example: 1
            indicators:
              type: array
              description: >-
                The indicators refer to those objects which are found by RCA or
                sweeping
              items:
                type: object
                properties:
                  id:
                    type: integer
                    example: 1
                  objectType:
                    type: string
                    example: url
                  objectValue:
                    type: string
                    example: 'http://www.DVftYKDtEi.com/ds7002.zip'
                  relatedEntities:
                    type: array
                    items:
                      type: string
                      example: 5257b401-2fd7-469c-94fa-39a4f11eb925
                  matchedIndicatorPatterns:
                    type: array
                    items:
                      type: string
                      example: 74f7eb0f-1ca3-491a-b4cf-f4d54c83c87d
                  firstSeen:
                    type: array
                    items:
                      type: string
                      example: '2019-06-14T18:25:55.000Z'
                  lastSeen:
                    type: array
                    items:
                      type: string
                      example: '2019-06-14T18:25:55.000Z'
            matchedIndicatorPatterns:
              type: array
              description: The matched indicator patterns
              items:
                type: object
                properties:
                  id:
                    type: string
                    example: 74f7eb0f-1ca3-491a-b4cf-f4d54c83c87d
                  pattern:
                    type: string
                    example: >-
                      [network-traffic:dst_ref.type = 'domain-name' AND
                      network-traffic:dst_ref.value = 'oauth20.xyz']
                  tags:
                    type: array
                    items:
                      type: string
                      example: STIX2.malicious-activity
                  matchedLogs:
                    type: array
                    items:
                      type: string
                      example: Lengthy log string
            alertTriggerTimestamp:
              type: string
              example: '2020-04-30T00:01:15.000Z'
            workbenchCompleteTimestamp:
              type: string
              example: '2030-04-30T00:01:16.000Z'
    Error:
      description: task error info
      type: object
      required:
        - code
        - message
        - innererror
      properties:
        code:
          type: string
          description: error class
          example: InternalError
        number:
          type: integer
          description: internal detail error code
          example: 4000102
        message:
          type: string
          description: detail error message
          example: DB error.
        innererror:
          type: object
          properties:
            code:
              type: string
              description: error sub class
              example: ExecInternalError
            innererror:
              type: object
              properties:
                code:
                  type: string
                  description: error code
                  example: DBExecError
                service:
                  type: string
                  description: internal error module name
                  example: arp
    400_Response:
      type: object
      description: Bad argument
      properties:
        error:
          type: object
          required:
            - code
            - message
            - innererror
          properties:
            code:
              type: string
              enum:
                - BadArgument
            message:
              type: string
              example: Product not connected
            innererror:
              type: object
              required:
                - code
                - innererror
              properties:
                code:
                  type: string
                innererror:
                  type: object
                  required:
                    - code
                  properties:
                    code:
                      type: string
                      description: error code
                    service:
                      type: string
                      description: internal error module name
                      example: svp
    401_Response:
      type: object
      description: Unauthorized
      properties:
        error:
          type: object
          required:
            - code
            - message
            - innererror
          properties:
            code:
              type: string
              enum:
                - Unauthorized
            message:
              type: string
              example: The token expires
            innererror:
              type: object
              required:
                - code
                - innererror
              properties:
                code:
                  type: string
                innererror:
                  type: object
                  required:
                    - code
                  properties:
                    code:
                      type: string
                      description: error code
                    service:
                      type: string
                      description: internal error module name
                      example: svp
    403_Response:
      type: object
      required:
        - error
      properties:
        error:
          description: error info
          type: object
          required:
            - code
            - message
            - innererror
          properties:
            code:
              type: string
              description: error class
              enum:
                - PermissionDeny
            message:
              type: string
              description: detail error message
              example: Role denied
            innererror:
              type: object
              required:
                - code
                - innererror
              properties:
                code:
                  type: string
                innererror:
                  type: object
                  required:
                    - code
                  properties:
                    code:
                      type: string
                      description: error code
                    service:
                      type: string
                      description: internal error module name
                      example: svp
    404_Response:
      type: object
      description: NotFound
      properties:
        error:
          type: object
          required:
            - code
            - message
            - innererror
          properties:
            code:
              type: string
              enum:
                - NotFound
            message:
              type: string
              example: Not found
            innererror:
              type: object
              required:
                - code
                - innererror
              properties:
                code:
                  type: string
                innererror:
                  type: object
                  required:
                    - code
                  properties:
                    code:
                      type: string
                      description: error code
                    service:
                      type: string
                      description: internal error module name
                      example: svp
    429_Response:
      type: object
      description: Too many request
      properties:
        error:
          type: object
          required:
            - code
            - message
            - innererror
          properties:
            code:
              type: string
              example:
                - TooManyRequest
            message:
              type: string
              example: Too many request
            innererror:
              type: object
              required:
                - code
                - innererror
              properties:
                code:
                  type: string
                innererror:
                  type: object
                  required:
                    - code
                  properties:
                    code:
                      type: string
                      description: error code
                    service:
                      type: string
                      description: internal error module name
                      example: svp
    500_Response:
      type: object
      description: Internal error
      properties:
        error:
          type: object
          required:
            - code
            - message
            - innererror
          properties:
            code:
              type: string
              enum:
                - InternalError
            message:
              type: string
              example: Internal processs timeout
            innererror:
              type: object
              required:
                - code
                - innererror
              properties:
                code:
                  type: string
                innererror:
                  type: object
                  required:
                    - code
                  properties:
                    code:
                      type: string
                      description: error code
                    service:
                      type: string
                      description: internal error module name
                      example: svp
  examples:
    saeWorkbenchDetailsExample:
      value:
        info:
          code: 3002000
          msg: Get workbench details successfully.
        data:
          schemaVersion: '1.0'
          workbenchId: WB-9002-20200427-0002
          workbenchLink: 'https://THE_WORKBENCH_URL'
          alertProvider: SAE
          model: Possible APT Attack
          description: Suspicious email followed by a possible backdoor implantation
          score: '63'
          modelSeverity: critical
          alertTriggerTimestamp: '2020-04-30T00:01:15.000Z'
          workbenchCompleteTimestamp: '2030-04-30T00:01:16.000Z'
          impactScope:
            - entityType: emailAddress
              entityValue: loki@jaguartm.onmicrosoft.com
              entityId: loki@jaguartm.onmicrosoft.com
              relatedEntities:
                - CODERED\\loki
              relatedIndicators:
                - 1
          indicators:
            - id: 1
              objectType: url
              objectValue: 'http://www.DVftYKDtEi.com/ds7002.zip'
              relatedEntities:
                - loki@jaguartm.onmicrosoft.com
              filterId:
                - f862df72-7f5e-4b2b-9f7f-9148e875f908
          matchedRules:
            - id: 5f52d1f1-53e7-411a-b74f-745ee81fa30b
              name: Possible SpearPhishing Email
              matchedFilters:
                - id: ccf86fc1-688f-4131-a46f-1d7a6ee2f88e
                  name: (T1192) Spearphishing Link
                  timestamp: '2019-08-02T04:00:01.000Z'
                  mitreTechniques:
                    - T1192
      summary: SAE workbench details
    tiWorkbenchDetailsExample:
      value:
        info:
          code: 3002000
          msg: Get workbench details successfully.
        data:
          schemaVersion: '1.1'
          workbenchId: WB-9002-20200427-0002
          workbenchLink: >-
            https://portal-int.visionone.trendmicro.com/index.html#/workbench?workbenchId=WB-9002-20200427-0002
          alertProvider: TI
          model: >-
            Desktop, Mobile Phishing Campaign Targets South Korean Websites,
            Steals Credentials Via Watering Hole
          campaign: Soula
          industry: n/a
          region/country: eastern-asia/Korea (the Republic of)
          createdBy: Trend Micro Research
          totalIndicatorNumber: 6
          matchedIndicatorNumber: 2
          reportLink: 'https://THE_WORKBENCH_URL'
          score: '63'
          modelSeverity: critical
          alertTriggerTimestamp: '2020-04-30T00:01:15.000Z'
          workbenchCompleteTimestamp: '2030-04-30T00:01:16.000Z'
          impactScope:
            - entityType: host
              entityValue:
                name: CODERED\\bonus-PC
                ips:
                  - 10.110.2.1
                guid: 5257b401-2fd7-469c-94fa-39a4f11eb925
              entityId: 5257b401-2fd7-469c-94fa-39a4f11eb925
              relatedEntities:
                - 4257b401-2fd7-469c-94fa-39a4f11eb925
              relatedIndicators:
                - 1
          indicators:
            - id: 1
              objectType: url
              objectValue: 'http://www.DVftYKDtEi.com/ds7002.zip'
              relatedEntities:
                - 5257b401-2fd7-469c-94fa-39a4f11eb925
              matchedIndicatorPatterns:
                - 74f7eb0f-1ca3-491a-b4cf-f4d54c83c87d
              firstSeen:
                - '2019-06-14T18:25:55.000Z'
              lastSeen:
                - '2019-06-14T18:25:55.000Z'
          matchedIndicatorPatterns:
            - id: 74f7eb0f-1ca3-491a-b4cf-f4d54c83c87d
              pattern: >-
                [network-traffic:dst_ref.type = 'domain-name' AND
                network-traffic:dst_ref.value = 'oauth20.xyz']
              tags:
                - STIX2.malicious-activity
              matchedLogs:
                - Lengthy log string
      summary: TI workbench details
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
security:
  - bearerAuth: []
tags:
  - name: Accounts
  - name: Alerts
  - name: API Authentication Token
  - name: Audit Logs
  - name: Connected Products
  - name: Details
  - name: Detection Models
  - name: Email
  - name: Endpoint
  - name: General
  - name: Notifications
  - name: On-premises
  - name: Password
  - name: Remote Support
  - name: Roles
  - name: SaaS
  - name: SAML
  - name: Search
  - name: Splunk
  - name: Sweeping
  - name: Threat Intelligence
  - name: Two-factor Authentication
x-tagGroups:
  - name: Accounts
    tags:
      - Accounts
      - API Authentication Token
      - Password
      - Roles
      - Two-factor Authentication
  - name: Alerts / Workbench
    tags:
      - Alerts
      - Details
      - Detection Models
      - Threat Intelligence
  - name: Audit Logs
    tags:
      - Audit Logs
  - name: Connected Products
    tags:
      - General
      - On-premises
      - SaaS
  - name: Notifications
    tags:
      - Notifications
  - name: Remote Support
    tags:
      - Remote Support
  - name: Response Actions
    tags:
      - Common
      - Email
      - Endpoint
  - name: Single Sign-On
    tags:
      - SAML
  - name: Search
    tags:
      - Search
      - Sweeping
  - name: SIEM
    tags:
      - Splunk
paths:
  '/v1.0/xdr/workbench/workbenches/{workbenchId}':
    get: &ref_0
      summary: Get alert details
      description: Retrieves information about the specified alert
      tags:
        - Details
      parameters:
        - name: workbenchId
          description: workbench id
          example: WB-14-20190709-0003
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          headers: []
          content:
            application/json:
              schema:
                properties:
                  error:
                    type: object
                    description: >
                      * 3002001: Unable to retrieve workbench details. Verify
                      that the request is properly formatted and try again.
                      (Error code: 3002001)

                      * 3002002: Unable to retrieve workbench details. Verify
                      that the specified customer ID exists and that you have
                      permission to access the customer's data and try again.
                      (Error code: 3002002)

                      * 3002003: Unable to retrieve workbench details. Verify
                      that the specified workbench ID exists and that you have
                      permission to access the workbench and try again. (Error
                      code: 3002003)

                      * 3002005: Unable to retrieve workbench details. This
                      workbench version is unsupported for workbench details.
                      (Error code: 3002005)
                    properties:
                      code:
                        type: string
                        example: '3002001'
                        enum:
                          - '3002001'
                          - '3002002'
                          - '3002003'
                          - '3002005'
                      message:
                        type: string
                        example: >-
                          Unable to retrieve workbench details. Verify that the
                          request is properly formatted and try again. (Error
                          code: 3002001)
                      innererror:
                        type: object
                        properties:
                          code:
                            type: string
                            example: ''
                discriminator:
                  propertyName: alertProvider
                  mapping:
                    SAE: '#/components/schemas/SAEWorkbenchDetails'
                    TI: '#/components/schemas/TIWorkbenchDetails'
              examples:
                saeWorkbenchDetailsExample:
                  $ref: '#/components/examples/saeWorkbenchDetailsExample'
                tiWorkbenchDetailsExample:
                  $ref: '#/components/examples/tiWorkbenchDetailsExample'
        '400':
          headers: []
          content:
            application/json:
              schema:
                properties:
                  error:
                    type: object
                    description: >
                      * 3002001: Unable to retrieve workbench details. Verify
                      that the request is properly formatted and try again.
                      (Error code: 3002001)

                      * 3002002: Unable to retrieve workbench details. Verify
                      that the specified customer ID exists and that you have
                      permission to access the customer's data and try again.
                      (Error code: 3002002)

                      * 3002003: Unable to retrieve workbench details. Verify
                      that the specified workbench ID exists and that you have
                      permission to access the workbench and try again. (Error
                      code: 3002003)

                      * 3002005: Unable to retrieve workbench details. This
                      workbench version is unsupported for workbench details.
                      (Error code: 3002005)
                    properties:
                      code:
                        type: string
                        example: '3002001'
                        enum:
                          - '3002001'
                          - '3002002'
                          - '3002003'
                          - '3002005'
                      message:
                        type: string
                        example: >-
                          Unable to retrieve workbench details. Verify that the
                          request is properly formatted and try again. (Error
                          code: 3002001)
                      innererror:
                        type: object
                        properties:
                          code:
                            type: string
                            example: ''
        '500':
          headers: []
          content:
            application/json:
              schema:
                properties:
                  error:
                    type: object
                    description: >
                      * 3002999: Unable to retrieve workbench details. An
                      internal error has occurred. Please try again later. If
                      the issue persists, contact Trend Micro Support. (Error
                      code: 3002999)
                    properties:
                      code:
                        type: string
                        example: '3002999'
                        enum:
                          - '3002999'
                      message:
                        type: string
                        example: >-
                          Unable to retrieve workbench details. An internal
                          error has occurred. Please try again later. If the
                          issue persists, contact Trend Micro Support. (Error
                          code: 3002999)
                      innererror:
                        type: object
                        properties:
                          code:
                            type: string
                            example: ''
    put: &ref_1
      summary: Edit alert status
      description: Modifies the investigation status of the specified alert
      tags:
        - Alerts
      parameters:
        - name: workbenchId
          description: workbench id
          example: WB-14-20190709-0003
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              example:
                investigationStatus: 1
              type: object
              properties:
                investigationStatus:
                  type: integer
                  description: >-
                    0: New, 1: In Progress, 2: Resolved: True Positive, 3:
                    Resolved: False Positive
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  info:
                    description: |
                      * 3006000 - Alert status changed successfully.
                    type: object
                    properties:
                      code:
                        description: code
                        type: integer
                        example: 3006000
                        enum:
                          - 3006000
                      msg:
                        description: msg
                        type: string
                        example: Alert status changed successfully.
                  data:
                    type: null
                    example: null
        '400':
          headers: []
          content:
            application/json:
              schema:
                properties:
                  error:
                    type: object
                    description: >
                      * 3006001 - Unable to change alert status. Verify that the
                      request is properly formatted and try again. (Error code:
                      3006001)

                      * 3006002 - Unable to change alert status. Verify that the
                      specified company exists and that you have permission to
                      access the company's data and try again. (Error code:
                      3006002)

                      * 3006003 - Unable to change alert status. Verify that all
                      requested workbench IDs exist and try again. (Error code:
                      3006003)
                    properties:
                      code:
                        type: string
                        example: '3006001'
                        enum:
                          - '3006001'
                          - '3006002'
                          - '3006003'
                      message:
                        type: string
                        example: >-
                          Unable to change alert status. Verify that the request
                          is properly formatted and try again. (Error code:
                          3006001)
                      innererror:
                        type: object
                        properties:
                          code:
                            type: string
                            example: ''
        '500':
          headers: []
          content:
            application/json:
              schema:
                properties:
                  error:
                    type: object
                    description: >
                      * 3006999 - Unable to change alert status. An internal
                      error has occurred. Please try again later. If the issue
                      persists, contact your support provider. (Error code:
                      3006999)
                    properties:
                      code:
                        type: string
                        example: '3006999'
                        enum:
                          - '3006999'
                      message:
                        type: string
                        example: >-
                          Unable to change alert status. An internal error has
                          occurred. Please try again later. If the issue
                          persists, contact your support provider. (Error code:
                          3006999)
                      innererror:
                        type: object
                        properties:
                          code:
                            type: string
                            example: ''
  '/beta/xdr/workbench/workbenches/{workbenchId}':
    get: *ref_0
    put: *ref_1
  /beta/xdr/workbench/workbenches/history:
    post:
      summary: Get alert history
      description: Retrieves a list of alerts in the Workbench app
      tags:
        - Alerts
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                startTime:
                  type: string
                  pattern: >-
                    ^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\.[0-9]{3}Z$
                  example: '2019-11-01T10:23:55.000Z'
                endTime:
                  type: string
                  pattern: >-
                    ^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\.[0-9]{3}Z$
                  example: '2019-11-01T10:23:55.000Z'
                investigationStatus:
                  description: >-
                    If All statuses are selected, leave it as null; otherwise,
                    put an array of integer(s); [0]: New; [1]: In Progress; [2]:
                    Resolved: True Positive; [3]: Resolved: False Positive
                  type: 'array, null'
                  items:
                    type: integer
                  example:
                    - 0
                sortBy:
                  description: >-
                    "investigationStatus" / "score" / "wbName" / "wbId" /
                    "createdTime" / "severity"; if it is desc, add a prefix "-"
                    (Ex: "-status")
                  type: string
                  pattern: >-
                    ^[-]?(investigationStatus|score|wbName|wbId|createdTime|severity)$
                  example: '-createdTime'
                queryTimeField:
                  description: >-
                    "updatedTime", "createdTime". The default value is
                    createdTime."
                  type: string
                  example: createdTime
                offset:
                  description: 0-based (0 means the 1st record; 50 means the 51st record)
                  type: integer
                  minimum: 0
                  example: 0
                limit:
                  description: 'record count in one page, 50/100/200'
                  type: integer
                  minimum: 1
                  example: 100
              required:
                - startTime
                - endTime
                - sortBy
                - offset
                - limit
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                example:
                  info:
                    code: 3008000
                    msg: Get workbench history successfully.
                  data:
                    totalCount: 1
                    modelList:
                      - Heartbeat Model
                      - Possible APT Attack
                      - Suspicious Web Access After Suspicious Email
                    workbenchRecords:
                      - investigationStatus: 1
                        priorityScore: 60
                        workbenchName: Heartbeat Model
                        workbenchId: WB-2-20200214-0003
                        workbenchLink: 'https://THE_WORKBENCH_URL'
                        createdTime: '2020-02-14T10:05:09Z'
                        updatedTime: '2020-02-15T10:05:09Z'
                        severity: critical
                        impactScope:
                          desktopCount: 10
                          serverCount: 0
                          accountCount: 1
                          emailAddressCount: 0
                properties:
                  info:
                    description: >
                      * 3008000 - Retrieve workbench summary information
                      successfully.
                    type: object
                    properties:
                      code:
                        description: code
                        type: integer
                        example: 3008000
                        enum:
                          - 3008000
                      msg:
                        description: msg
                        type: string
                        example: Retrieve workbench summary information successfully.
                  data:
                    type: object
                    properties:
                      totalCount:
                        description: Total count
                        type: integer
                      modelList:
                        description: >-
                          Distinct model list of visible workbenches of the
                          current customer
                        type: array
                        items:
                          type: string
                      workbenchRecords:
                        description: Workbench records returned
                        type: array
                        items:
                          properties:
                            investigationStatus:
                              type: integer
                              description: >-
                                0: New, 1: In Progress, 2: Resolved: True
                                Positive, 3: Resolved: False Positive
                            priorityScore:
                              example: 60
                              type: integer
                            workbenchName:
                              example: Heartbeat Model
                              type: string
                            workbenchId:
                              example: WB-2-20200214-0003
                              type: string
                            workbenchLink:
                              example: 'https://THE_WORKBENCH_URL'
                              type: string
                            createdTime:
                              example: '2020-02-14T10:05:09Z'
                              type: string
                            updatedTime:
                              example: '2020-02-15T10:05:09Z'
                              type: string
                            severity:
                              description: >-
                                Now it would be "critical" / "high" / "medium" /
                                "low"; null if it cannot be got (i.e.,
                                "severity": null)
                              example: critical
                              type: string
                            impactScope:
                              type: object
                              properties:
                                desktopCount:
                                  type: integer
                                serverCount:
                                  type: integer
                                accountCount:
                                  type: integer
                                emailAddressCount:
                                  type: integer
        '400':
          headers: []
          content:
            application/json:
              schema:
                properties:
                  error:
                    type: object
                    description: >
                      * 3008001 - Unable to retrieve workbench summary
                      information. Verify that the request is properly formatted
                      and try again. (Error code: 3008001)

                      * 3008002 - Unable to retrieve workbench summary
                      information. Verify that the specified company exists and
                      that you have permission to access the company's data and
                      try again. (Error code: 3008002)
                    properties:
                      code:
                        type: string
                        example: '3008001'
                        enum:
                          - '3008001'
                          - '3008002'
                      message:
                        type: string
                        example: >-
                          Unable to retrieve workbench summary information.
                          Verify that the request is properly formatted and try
                          again. (Error code: 3008001)
                      innererror:
                        type: object
                        properties:
                          code:
                            type: string
                            example: ''
        '500':
          headers: []
          content:
            application/json:
              schema:
                properties:
                  error:
                    type: object
                    description: >
                      * 3008999: Unable to retrieve workbench summary
                      information. An internal error has occurred. Please try
                      again later. If the issue persists, contact Trend Micro
                      Support. (Error code: 3008999)
                    properties:
                      code:
                        type: string
                        example: '3008999'
                        enum:
                          - '3008999'
                      message:
                        type: string
                        example: >-
                          Unable to retrieve workbench summary information. An
                          internal error has occurred. Please try again later.
                          If the issue persists, contact Trend Micro Support.
                          (Error code: 3008999)
                      innererror:
                        type: object
                        properties:
                          code:
                            type: string
                            example: ''
  /beta/xdr/search/data:
    post:
      tags:
        - Search
      summary: Search for data and list all results
      description: >-
        Searches data sources using the specified query criteria and retrieves a
        paginated list of matching records
      parameters: []
      requestBody:
        description: Search Data
        content:
          application/json:
            schema:
              required:
                - dataSource
                - from
                - query
                - to
              type: object
              properties:
                from:
                  type: integer
                  description: UTC timestamp for search beginning time
                  example: 1587892612
                to:
                  type: integer
                  description: UTC timestamp for search ending time
                  example: 1592382065
                dataSource:
                  type: integer
                  description: |
                    Which Datalake, available values
                      - 1 for message
                      - 2 for endpoint
                      - 8 for network
                  example: 1
                count:
                  type: integer
                  description: |
                    Limit records for one search
                      - 500 as default
                      - 1000 by most
                  example: 500
                searchType:
                  type: integer
                  description: |
                    Which search method, available values
                      - 1 for query builder by default if not provided
                  example: 1
                dataType:
                  type: integer
                  description: |
                    data type, available values
                      - 1 for telemetry data by default if not provided
                      - 2 for detection

                    note: dataSource(2,8) and dataType(1) is unavailable now
                  example: 1
                nextLink:
                  type: string
                  description: >-
                    Next page data request address, it came from search response
                    result data.nextLink field, like
                    skipToken=WzE1ODk3NzIxMzEwMDAsIkFBTWtBR1k0TldRMVkyUmhMVGxrWXprdE5EbGhZaTA1WVRreUxXRTJPVGd3WmpVMlpEZzVaQUJHQUFBQUFBQXlpZVl5REV4L1RhZlNiU0sxaVMzc0J3Q252NDl0dmtZRFFJb2hIVHN0UFRvZEFBQUFBQUVNQUFDbnY0OXR2a1lEUUlvaEhUc3RQVG9kQUFCWStscmlBQUE9Il0=
                  example: ''
                query:
                  type: object
                  properties:
                    type:
                      type: string
                      description: |
                        query builder conditions format value
                         - group by default if not provided
                      example: group
                    match:
                      type: string
                      description: |
                        operator between search conditions, available values
                          - all,  by default if none of both
                          - any
                      example: all
                    rows:
                      type: array
                      items:
                        required:
                          - content
                          - optionField
                          - searchField
                        type: object
                        properties:
                          type:
                            type: string
                            description: |
                              one search field type, available values
                               - row by default if not provided
                            example: row
                          searchField:
                            type: string
                            description: |
                              message telemetry (dataSource 1, dataType 1)
                                | searchField  | optionField |
                                |---------|----------------|
                                | ip  | equals      |
                                | dns | equals/contains |
                                | url | equals/contains |
                                | sender | equals/contains |
                                | message_id  | equals      |
                                | subject | equals/contains |
                                | file_name | equals/contains |
                                | file_sha1 | equals |
                                | mailbox | equals/contains |
                                | recipient | equals/contains |

                              message detection (dataSource 1, dataType 2)
                                | searchField  | optionField |
                                |---------|----------------|
                                | url | equals/contains |
                                | file_name | equals/contains |
                                | file_sha1 | equals |
                                | mailbox | equals/contains |
                                | rule_name | equals/contains |

                              endpoint detection (dataSource 2, dataType 2)
                                | searchField  | optionField |
                                |---------|----------------|
                                | ip  | equals      |
                                | fqdn | equals/contains |
                                | url | equals/contains |
                                | account | equals/contains |
                                | rule_id  | equals      |
                                | host_name | equals/contains |
                                | file_name | equals/contains |
                                | file_sha1 | equals |
                                | rule_name | equals/contains |
                                | malware_name | equals/contains |

                              network detection (dataSource 8, dataType 2)
                                | searchField  | optionField |
                                |---------|----------------|
                                | ip  | equals      |
                                | fqdn | equals/contains |
                                | url | equals/contains |
                                | account | equals/contains |
                                | rule_id  | equals      |
                                | host_name | equals/contains |
                                | file_name | equals/contains |
                                | file_sha1 | equals |
                                | rule_name | equals/contains |
                                | malware_name | equals/contains |
                            example: dns
                          optionField:
                            type: string
                            description: |
                              search field operator, available values
                                - contains
                                - equals
                            example: contains
                          content:
                            type: array
                            description: search content list
                            items:
                              type: string
                              example: .com
        required: true
      responses:
        '200':
          description: success
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                    description: return code
                    example: 200
                  message:
                    type: string
                    description: search return message
                    example: success
                  data:
                    type: object
                    properties:
                      totalCount:
                        type: integer
                        description: >-
                          all the matched result, if more than 1000, need query
                          rest data use nextLink
                        example: 2
                      nextLink:
                        type: string
                        description: next page data request address
                        example: >-
                          skipToken=WzE1ODk3NzIxMzEwMDAsIkFBTWtBR1k0TldRMVkyUmhMVGxrWXprdE5EbGhZaTA1WVRreUxXRTJPVGd3WmpVMlpEZzVaQUJHQUFBQUFBQXlpZVl5REV4L1RhZlNiU0sxaVMzc0J3Q252NDl0dmtZRFFJb2hIVHN0UFRvZEFBQUFBQUVNQUFDbnY0OXR2a1lEUUlvaEhUc3RQVG9kQUFCWStscmlBQUE9Il0=
                      value:
                        type: array
                        description: >
                          datalake return list of key and its value

                           message telemetry value (dataSource 1, dataType 1)

                            | key  | value type |
                            |---------|----------------|
                            | mail_message_sender  | string      |
                            | mail_message_recipient |array |
                            | mail_message_subject | string |
                            | mailbox | string |
                            | source_domain  | string      |
                            | mail_urls | array |
                            | source_ip | string |
                            | mail_message_delivery_time | string |
                            | mail_message_id | string |
                            | mail_unique_id | string|
                            | mail_attachments | array |
                            | mail_internet_headers | array |

                          detection result field available list for every
                          available dataSource
                            - attachmentFileHash
                            - attachmentFileHashMd5
                            - attachmentFileHashSha1
                            - attachmentFileHashSha256
                            - attachmentFileName
                            - botUrl
                            - cccaDestination
                            - compressedFileHash
                            - compressedFileHashSha256
                            - compressedFileName
                            - denyListFileHash
                            - denyListHost
                            - denyListIp
                            - dhost
                            - dst
                            - endpointHostName
                            - endpointIp
                            - fileHash
                            - fileHashSha256
                            - fileName
                            - hostName
                            - interestedHost
                            - interestedIp
                            - malName
                            - objectDomain
                            - objectFileHashMd5
                            - objectFileHashSha1
                            - objectFileHashSha256
                            - objectFileName
                            - oldFileHash
                            - peerIp
                            - request
                            - ruleId
                            - ruleName
                            - shost
                            - src
                            - suid
                            - userDomain

                            note: search result matched result fields include not empty value of fields above at least, other fields need check real result.
                        example:
                          - mail_message_sender: xxx@maildomain.com
                            mail_message_recipient:
                              - yyy@maildomain
                            mail_message_subject: test123
                            mailbox: yyy@maildomain
                            mail_urls:
                              - 'https://www.trendmicro.com/'
                            source_domain: domain.com
                            source_ip: 1.1.1.1
                            mail_message_delivery_time: 2020-03-20T02:13:58.000Z
                            mail_message_id: <5772876ad1654da29ac3c9d470477837@maildomain.com>
                            mail_unique_id: >-
                              AAMkADllYTcxODA4LWYzZDQtNGI3Ny1iNjFkLTc4NGJmM2M2M2NlOQBGAAAAAADS4iErPwU8Tav4gGK0eC4TBwD1R8CjNBg8T5OK7jBOttj5AAAAAAEMAAD1R8CjNBg8T5OK7jBOttj5AAAydH7NAAA=
                            mail_attachments:
                              - file_sha1: 34924b49e416befd1106cad406d413e6e4a89563
                              - file_name: test.txt
                            mail_internet_headers:
                              - 'Return-Path:maildomain.com'
                              - >-
                                Authentication-Results:spf=pass (sender IP is
                                1.1.1.1) smtp.mailfrom=trendmicro.com;
                                xdrsearchapp.onmicrosoft.com; dmarc=pass
                                action=none header.from=domain.com;compauth=pass
                                reason=100
                          - mail_message_sender: xxx2@maildomain.com
                            mail_message_recipient:
                              - xxx3@maildomain.com
                            mail_message_subject: ä¸­ææµè¯2
                            mailbox: xxx3@maildomain.com
                            mail_urls:
                              - www.example.com
                              - 'https://www.trendmicro.com'
                            source_domain: maildomain.com
                            source_ip: 6.6.6.6
                            mail_message_delivery_time: 2020-03-20T01:59:45.000Z
                            mail_message_id: >-
                              <BL0PR01MB4803DE8FD2D4D42E22EB873B915B0@BL0PR01MB4803.maildomain.com>
                            mail_unique_id: >-
                              AAMkADlmYmQyYzM5LWZlODUtNGQ3ZS1hYTYwLTdlYTQ0YWYyOTRmZABGAAAAAACsED2h8atcSL+hshoTiZPQBwC9pwhjLWzfS4fwzicn24zvAAAAAAEMAAC9pwhjLWzfS4fwzicn24zvendmail.com;compauth=pass
                              reason=100
                            mail_attachments: []
                            mail_internet_headers: []
                        items:
                          type: object
                          description: each log record content
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        enum:
                          - BadRequest
                      message:
                        type: string
                        example: Bad Request
                      innererror:
                        required:
                          - code
                          - innererror
                        type: object
                        properties:
                          code:
                            type: string
                            example: BadArgument
                          innererror:
                            required:
                              - code
                            type: object
                            properties:
                              code:
                                type: string
                                description: |
                                  inner error code
                                    - UnsupportedData
                                    - InvalidSearchField
                                    - InvalidSearchOperator
                                    - RequiredHeaderMissing
                                    - ValueInvalidFormat
                              reason:
                                type: string
                                description: |
                                  corresponding to the code
                                   | code  | reason content | example|
                                   |-------|--------|-------|
                                   | UnsupportedData | of request body value is invalid | dataSource of request body value is invalid |
                                   | UnsupportedData | of request header's value must be | Content-Type of request header's value must be application/json  |
                                   |InvalidSearchField| of request body searchField is invalid for dataSource| ip1 of request body searchField is invalid for dataSource: 1|
                                   |InvalidSearchOperator|of request body optionField is invalid for search field|contains of request body optionField is invalid for search field:ip|
                                   |RequiredHeaderMissing|Missing required request header:|Missing required request header: X-Customer-ID|
                                   |ValueInvalidFormat|request body format invalid|request body format invalid|
                              service:
                                type: string
                                description: internal error module name
                                example: search
        '408':
          description: Request timeout error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        enum:
                          - RequestTimeout
                      message:
                        type: string
                        example: Request Timeout
        '429':
          description: Too many requests
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        enum:
                          - TooManyRequest
                      message:
                        type: string
                        example: Too Many Requests
        '500':
          description: Internal Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    required:
                      - code
                      - message
                    properties:
                      code:
                        type: string
                        enum:
                          - InternalError
                      message:
                        type: string
                        example: >
                          - Internal Server Error - content returned by service
                          platform
  /beta/xdr/search/aggregation:
    post:
      tags:
        - Search
      summary: Search for data and list top results
      description: >-
        Searches data sources using the specified query criteria and retrieves a
        list of "top n" matching records
      parameters: []
      requestBody:
        description: Search aggregation data
        content:
          application/json:
            schema:
              required:
                - dataSource
                - from
                - query
                - to
              type: object
              properties:
                from:
                  type: integer
                  description: UTC timestamp for search beginning time
                  example: 1587892612
                to:
                  type: integer
                  description: UTC timestamp for search ending time
                  example: 1592382065
                dataSource:
                  type: integer
                  description: |
                    Which Datalake, available values
                      - 1 for message
                      - 2 for endpoint
                      - 8 for network
                  example: 1
                searchType:
                  type: integer
                  description: |
                    Which search method, available values
                      - 1 for query builder by default if not provided
                  example: 1
                dataType:
                  type: integer
                  description: |
                    data type, available values
                      - 1 for telemetry data by default if not provided
                      - 2 for detection

                    note: dataSource(2, 8) and dataType(1) is unavailable now
                  example: 1
                topn:
                  type: integer
                  description: 'top number for aggregation field, 10 by default'
                  example: 10
                query:
                  type: object
                  properties:
                    type:
                      type: string
                      description: |
                        query builder conditions format value
                         - group by default if not provided
                      example: group
                    match:
                      type: string
                      description: |
                        operator between search conditions, available values
                          - all,  by default if none of both
                          - any
                      example: all
                    rows:
                      type: array
                      items:
                        required:
                          - content
                          - optionField
                          - searchField
                        type: object
                        properties:
                          type:
                            type: string
                            description: |
                              one search field type, available values
                               - row by default if not provided
                            example: row
                          searchField:
                            type: string
                            description: |
                              message telemetry (dataSource 1, dataType 1)
                                | searchField  | optionField |
                                |---------|----------------|
                                | ip  | equals      |
                                | dns | equals/contains |
                                | url | equals/contains |
                                | sender | equals/contains |
                                | message_id  | equals      |
                                | subject | equals/contains |
                                | file_name | equals/contains |
                                | file_sha1 | equals |
                                | mailbox | equals/contains |
                                | recipient | equals/contains |

                              message detection (dataSource 1, dataType 2)
                                | searchField  | optionField |
                                |---------|----------------|
                                | url | equals/contains |
                                | file_name | equals/contains |
                                | file_sha1 | equals |
                                | mailbox | equals/contains |
                                | rule_name | equals/contains |

                              endpoint detection (dataSource 2, dataType 2)
                                | searchField  | optionField |
                                |---------|----------------|
                                | ip  | equals      |
                                | fqdn | equals/contains |
                                | url | equals/contains |
                                | account | equals/contains |
                                | rule_id  | equals      |
                                | host_name | equals/contains |
                                | file_name | equals/contains |
                                | file_sha1 | equals |
                                | rule_name | equals/contains |
                                | malware_name | equals/contains |

                              network detection (dataSource 8, dataType 2)
                                | searchField  | optionField |
                                |---------|----------------|
                                | ip  | equals      |
                                | fqdn | equals/contains |
                                | url | equals/contains |
                                | account | equals/contains |
                                | rule_id  | equals      |
                                | host_name | equals/contains |
                                | file_name | equals/contains |
                                | file_sha1 | equals |
                                | rule_name | equals/contains |
                                | malware_name | equals/contains |
                            example: dns
                          optionField:
                            type: string
                            description: |
                              search field operator, available values
                                - contains
                                - equals
                            example: contains
                          content:
                            type: array
                            description: search content list
                            items:
                              type: string
                              example: .com
        required: true
      responses:
        '200':
          description: success
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                    description: return code
                    example: 200
                  message:
                    type: string
                    description: search return message
                    example: success
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        key:
                          type: string
                          description: >
                            aggregation field name

                             message telemetry aggregation field list (dataSource 1, dataType 1)
                              - file_name
                              - file_sha1
                              - mail_message_id
                              - mail_message_sender
                              - mail_urls
                              - mailbox
                              - source_domain
                              - source_ip


                             detection aggregation field available list for every available dataSource
                              - attachmentFileHash
                              - attachmentFileHashMd5
                              - attachmentFileHashSha1
                              - attachmentFileHashSha256
                              - attachmentFileName
                              - botUrl
                              - cccaDestination
                              - compressedFileHash
                              - compressedFileHashSha256
                              - compressedFileName
                              - denyListFileHash
                              - denyListHost
                              - denyListIp
                              - dhost
                              - dst
                              - endpointHostName
                              - endpointIp
                              - fileHash
                              - fileHashSha256
                              - fileName
                              - hostName
                              - interestedHost
                              - interestedIp
                              - malName
                              - objectDomain
                              - objectFileHashMd5
                              - objectFileHashSha1
                              - objectFileHashSha256
                              - objectFileName
                              - oldFileHash
                              - peerIp
                              - request
                              - ruleId
                              - ruleName
                              - shost
                              - src
                              - suid
                              - userDomain


                            note: aggegation result only returned matched list
                            item and filter out empty field and sort by
                            alphabetic
                          example: sender
                        value:
                          type: array
                          description: >-
                            aggregation topn value list matching search
                            conditions
                          example:
                            - key: top1@sender.domain
                              count: 141
                            - key: top2@sender.domain
                              count: 14
                          items:
                            type: object
                            properties:
                              key:
                                type: string
                                description: aggregation field name
                              count:
                                type: number
                                description: number of recorded log
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        enum:
                          - BadRequest
                      message:
                        type: string
                        example: Bad Request
                      innererror:
                        required:
                          - code
                          - innererror
                        type: object
                        properties:
                          code:
                            type: string
                            example: BadArgument
                          innererror:
                            required:
                              - code
                            type: object
                            properties:
                              code:
                                type: string
                                description: |
                                  inner error code
                                    - UnsupportedData
                                    - InvalidSearchField
                                    - InvalidSearchOperator
                                    - RequiredHeaderMissing
                                    - ValueInvalidFormat
                              reason:
                                type: string
                                description: |
                                  corresponding to the code
                                   | code  | reason content | example|
                                   |-------|--------|-------|
                                   | UnsupportedData | of request body value is invalid | dataSource of request body value is invalid |
                                   | UnsupportedData | of request header's value must be | Content-Type of request header's value must be application/json  |
                                   |InvalidSearchField| of request body searchField is invalid for dataSource| ip1 of request body searchField is invalid for dataSource: 1|
                                   |InvalidSearchOperator|of request body optionField is invalid for search field|contains of request body optionField is invalid for search field:ip|
                                   |RequiredHeaderMissing|Missing required request header:|Missing required request header: X-Customer-ID|
                                   |ValueInvalidFormat|request body format invalid|request body format invalid|
                              service:
                                type: string
                                description: internal error module name
                                example: search
        '408':
          description: Request timeout error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        enum:
                          - RequestTimeout
                      message:
                        type: string
                        example: Request Timeout
        '429':
          description: Too many requests
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        enum:
                          - TooManyRequest
                      message:
                        type: string
                        example: Too Many Requests
        '500':
          description: Internal Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    required:
                      - code
                      - message
                    properties:
                      code:
                        type: string
                        enum:
                          - InternalError
                      message:
                        type: string
                        example: >
                          - Internal Server Error - content returned by service
                          platform
  /beta/xdr/threatintel/reports:
    get:
      description: List reports in the threat intelligence feed
      parameters:
        - description: 'report last update time range, if not set, default is all'
          example: 30
          in: query
          name: range
          required: false
          schema:
            type: integer
        - description: 'report name filter string, default show all'
          example: Zwrot
          in: query
          name: filter
          required: false
          schema:
            type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  data:
                    description: Return data
                    items:
                      properties:
                        report--2c1091ba-a7d2-46b2-bf97-4137916c30cb:
                          properties:
                            enrich:
                              properties:
                                campaign:
                                  description: The associated threat campaign
                                  example: Tropic Trooper
                                  type: string
                                lastUpdated:
                                  description: last update time
                                  example: 1568258055
                                  type: integer
                                platform:
                                  description: The operating system targeted by the threat
                                  example: Riot
                                  type: string
                                region/country:
                                  description: The region or country targeted by the threat
                                  example: 'eastern-asia,americas'
                                  type: string
                              type: object
                            external_references:
                              items:
                                required:
                                  - url
                                  - source_name
                              properties:
                                source_name:
                                  example: Reference URL
                                  type: string
                                url:
                                  example: >-
                                    https://blog.trendmicro.com/trendlabs-security-intelligence/bashlite-iot-malware-updated-with-mining-and-backdoor-commands-targets-wemo-devices/
                                  type: string
                              type: array
                            id:
                              example: report--2c1091ba-a7d2-46b2-bf97-4137916c30cb
                              type: string
                            name:
                              example: >-
                                Republish: Bashlite IoT Malware Updated with
                                Mining and Backdoor Commands, Targets WeMo
                                Devices
                              type: string
                          type: object
                    type: array
          description: OK
        '400':
          description: bad argument
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/400_Response'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/401_Response'
        '403':
          description: PermissionDeny
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/403_Response'
        '404':
          description: NotFound
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/404_Response'
        '500':
          description: Internal error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/500_Response'
      summary: List threat intelligence reports
      tags:
        - Threat Intelligence
      x-code-samples:
        - lang: Python
          source: >-
            import requests import json url_base =
            'https://api.xdr.trendmicro.com' url_path =
            '/v1.0/xdr/threatintel/reports' token = 'YOUR_TOKEN' query_params =
            {} headers = {'Authorization': 'Bearer ' + token, 'Content-Type':
            'application/json;charset=utf-8'} r = requests.get(url_base +
            url_path, params=query_params, headers=headers) print(r.status_code)
            if 'application/json' in r.headers.get('Content-Type', ''):
                print(json.dumps(r.json(), indent=4))
            else:
                print(r.text)
  /beta/xdr/models:
    get:
      description: >-
        Retrieves a list of enabled detection models, including information such
        as risk level and required products
      responses:
        '200':
          content:
            '*/*':
              schema:
                properties:
                  data:
                    description: Return data
                    items:
                      properties:
                        available:
                          description: available change status.
                          example: true
                          type: boolean
                        enabled:
                          description: current model status
                          example: true
                          type: boolean
                        lastUpdate:
                          description: last update time
                          example: '2020-06-09T10:45:39.000Z'
                          type: string
                        lastUpdateSec:
                          description: last update time in second format
                          example: 1591699539
                          type: integer
                        modelId:
                          description: model id.
                          example: sae-30a82216-2eab-4dfc-88a7-66fd61d4e6ce
                          type: string
                        name:
                          description: model name.
                          example: Possible Backdoor implantation
                          type: string
                        requiredProductLogic:
                          description: >-
                            the logic of required products, the top level is
                            "and" relation, the sub level is "or" relation, e.g.
                            â[[A,B],[C,D]]â = (Product A or Product B) AND
                            (Product C or Product D)
                          example:
                            - - sao
                              - sds
                            - - sca
                          items:
                            items:
                              type: string
                            type: array
                          type: array
                        requiredProductList:
                          description: requiredProductLogic in flat array
                          example:
                            - sao
                            - sds
                            - sca
                          type: array
                          items:
                            type: string
                        riskLevel:
                          description: risk level.
                          example: High
                          type: string
                        sourceType:
                          description: source type
                          enum:
                            - SAE
                            - TI
                          type: string
                        description:
                          description: Rule description
                          type: string
                      required:
                        - modelId
                        - name
                        - enabled
                        - available
                        - riskLevel
                        - lastUpdate
                        - lastUpdateSec
                        - sourceType
                        - description
                    type: array
                  product:
                    description: the registered products list for current customer
                    example:
                      - sna
                    items:
                      type: string
                    type: array
          description: OK
        '206':
          content:
            application/json:
              schema:
                properties:
                  error:
                    description: error info
                    type: object
                    required:
                      - code
                      - number
                      - message
                      - innererror
                    properties:
                      code:
                        type: string
                        description: error class
                        example: PartialContent
                      number:
                        type: integer
                        description: internal detail error code
                        example: 4000010
                        enum:
                          - 4000010
                      message:
                        type: string
                        description: detail error message
                        example: query UIC product failed
                      innererror:
                        type: object
                        properties:
                          code:
                            type: string
                            description: error sub class
                            example: Success
                          innererror:
                            type: object
                            properties:
                              code:
                                type: string
                                description: error code
                                example: DuplicateAction
                              service:
                                type: string
                                description: internal error module name
                                example: ars
                  data:
                    description: Return data
                    items:
                      properties:
                        available:
                          description: available change status.
                          example: true
                          type: boolean
                        enabled:
                          description: current model status
                          example: true
                          type: boolean
                        lastUpdate:
                          description: last update time
                          example: '2020-06-09T10:45:39.000Z'
                          type: string
                        lastUpdateSec:
                          description: last update time in second format
                          example: 1591699539
                          type: integer
                        modelId:
                          description: model id.
                          example: sae-30a82216-2eab-4dfc-88a7-66fd61d4e6ce
                          type: string
                        name:
                          description: model name.
                          example: Possible Backdoor implantation
                          type: string
                        requiredProductLogic:
                          description: >-
                            the logic of required products, the top level is
                            "and" relation, the sub level is "or" relation, e.g.
                            â[[A,B],[C,D]]â = (Product A or Product B) AND
                            (Product C or Product D)
                          example:
                            - - sao
                              - sds
                            - - sca
                          items:
                            items:
                              type: string
                            type: array
                          type: array
                        requiredProductList:
                          description: requiredProductLogic in flat array
                          example:
                            - sao
                            - sds
                            - sca
                          type: array
                          items:
                            type: string
                        riskLevel:
                          description: risk level.
                          example: High
                          type: string
                        sourceType:
                          description: source type
                          enum:
                            - SAE
                            - TI
                          type: string
                      required:
                        - modelId
                        - name
                        - enabled
                        - available
                        - riskLevel
                        - lastUpdate
                        - lastUpdateSec
                        - sourceType
                        - description
                    type: array
                  product:
                    description: the registered products list for current customer
                    example:
                      - null
                    items:
                      type: string
                    type: array
          description: query UIC product list failed
        '400':
          description: bad argument
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/400_Response'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/401_Response'
        '403':
          description: PermissionDeny
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/403_Response'
        '404':
          description: NotFound
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/404_Response'
        '500':
          description: Internal error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/500_Response'
      summary: List enabled detection models
      tags:
        - Detection Models
      x-code-samples:
        - lang: Python
          source: >-
            import requests

            import json


            url_base = 'https://api.xdr.trendmicro.com'

            url_path = '/v1.0/xdr/models'

            token = 'YOUR_TOKEN'


            query_params = {}

            headers = {'Authorization': 'Bearer ' + token, 'Content-Type':
            'application/json;charset=utf-8'}


            r = requests.get(url_base + url_path, params=query_params,
            headers=headers)


            print(r.status_code)

            if 'application/json' in r.headers.get('Content-Type', ''):
                print(json.dumps(r.json(), indent=4))
            else:
                print(r.text)
  '/v1.0/xdr/models/{id}':
    post:
      description: Enables or disables a detection model
      parameters:
        - description: model id
          example: sae-30a82216-2eab-4dfc-88a7-66fd61d4e6ce
          in: path
          name: id
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              required:
                - enable
              properties:
                enable:
                  description: model status
                  example: true
                  type: boolean
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  data:
                    description: Return data
                    properties:
                      enable:
                        description: model new status.
                        example: true
                        type: boolean
                    type: object
          description: OK
        '400':
          description: bad argument
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/400_Response'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/401_Response'
        '403':
          description: PermissionDeny
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/403_Response'
        '404':
          description: NotFound
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/404_Response'
        '500':
          description: Internal error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/500_Response'
      summary: Enable or disable a detection model
      tags:
        - Detection Models
      x-code-samples:
        - lang: Python
          source: >-
            import requests

            import json


            url_base = 'https://api.xdr.trendmicro.com'

            url_path = '/v1.0/xdr/models/{id}'

            url_path = url_path.format(**{'id': 'YOUR_ID'})

            token = 'YOUR_TOKEN'


            query_params = {}

            body = '''

            {
                "enable": "YOUR_ENABLE (boolean)"
            }

            '''

            headers = {'Authorization': 'Bearer ' + token , 'Content-Type':
            'application/json;charset=utf-8'}


            r = requests.post(url_base + url_path, params=query_params,
            headers=headers, data=body)


            print(r.status_code)

            if 'application/json' in r.headers.get('Content-Type', ''):
                print(json.dumps(r.json(), indent=4))
            else:
                print(r.text) 
  /v2.0/siem/events:
    get:
      description: >-
        Retrieves a list of alerts from one or more data sources for a specific
        period
      parameters:
        - description: 'all (default), workbench...'
          example: all
          in: query
          name: source
          required: false
          schema:
            type: string
        - description: >
            Start and end time during which logs are to retrieve. Format: ISO
            8601 timestamp to the millisecond in UTC, yyyy-mm-ddThh:mm:ss.mmmZ.

            If both start and end are not specified, the request retrieves logs
            within five minutes before the point of time when the request is
            sent.

            If both start and end are specified, the request retrieves logs
            within the configured duration. Make sure the end time is no earlier
            than the start time.

            If only start is specified, the request retrieves logs within five
            minutes after the point of the configured start time.

            If only end is specified, the request retrieves logs within five
            minutes before the point of the configured end time.
          example: '2020-06-15T10:00:00.000Z'
          in: query
          name: startDateTime
          schema:
            type: string
        - description: above
          example: '2020-06-15T12:00:00.000Z'
          in: query
          name: endDateTime
          schema:
            type: string
        - description: >-
            If All status is selected, leave it as null; otherwise, put an array
            of integer(s); [0]: New; [1]: In Progress; [2]: Resolved: True
            Positive; [3]: Resolved: False Positive
          example: 0
          in: query
          name: investigationStatus
          schema:
            type:
              - array
              - 'null'
        - description: >-
            "investigationStatus" / "score" / "wbName" / "wbId" / "createdTime"
            / "severity"; if it is desc, add a prefix "-" (Ex: "-status")
          example: '-createdTime'
          in: query
          name: sortBy
          schema:
            type: string
        - description: '"updatedTime", "createdTime". The default value is createdTime."'
          name: queryTimeField
          example: createdTime
          in: query
          schema:
            type: string
        - description: 0-based (0 means the 1st record; 50 means the 51st record)
          example: 0
          in: query
          name: offset
          schema:
            type: integer
        - description: 'record count in one page, 50/100/200'
          example: 100
          in: query
          name: limit
          schema:
            type: integer
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                example:
                  info:
                    code: 3008000
                    msg: Get workbench history successfully.
                  data:
                    totalCount: 1
                    workbenchRecords:
                      - investigationStatus: 1
                        priorityScore: 60
                        workbenchName: Heartbeat Model
                        workbenchId: WB-2-20200214-0003
                        workbenchLink: >-
                          https://portal-int.visionone.trendmicro.com/index.html#/workbench?workbenchId=WB-2-20200214-0003
                        createdTime: '2020-02-14T10:05:09Z'
                        severity: critical
                        impactScope:
                          desktopCount: 10
                          serverCount: 0
                          accountCount: 1
                          emailAddressCount: 0
                properties:
                  info:
                    description: >
                      * 3008000 - Retrieve workbench summary information
                      successfully. 
                    type: object
                    properties:
                      code:
                        description: code
                        type: string
                        example: 3008000
                        enum:
                          - 3008000
                      msg:
                        description: msg
                        type: string
                        example: Retrieve workbench summary information successfully.
                  data:
                    type: object
                    properties:
                      totalCount:
                        description: Total count
                        type: integer
                      workbenchRecords:
                        description: Workbench records returned
                        type: array
                        items:
                          properties:
                            investigationStatus:
                              type: integer
                              description: >-
                                0: New, 1: In Progress, 2: Resolved: True
                                Positive, 3: Resolved: False Positive
                            priorityScore:
                              type: integer
                              description: null
                            workbenchName:
                              example: Heartbeat Model
                              type: string
                            workbenchId:
                              example: WB-2-20200214-0003
                              type: string
                            workbenchLink:
                              example: >-
                                https://portal-int.visionone.trendmicro.com/index.html#/workbench?workbenchId=WB-2-20200214-0003
                              type: string
                            createdTime:
                              example: '2020-02-14T10:05:09Z'
                              type: string
                            severity:
                              description: >-
                                Now it would be "critical" / "high" / "medium" /
                                "low"; null if it cannot be got (i.e.,
                                "severity": null)
                              example: critical
                              type: string
                            impactScope:
                              type: object
                              properties:
                                desktopCount:
                                  type: integer
                                serverCount:
                                  type: integer
                                accountCount:
                                  type: integer
                                emailAddressCount:
                                  type: integer
        '400':
          content:
            application/json:
              schema:
                properties:
                  error:
                    type: object
                    description: >
                      * 3008001 - Unable to retrieve workbench summary
                      information. Verify that the request is properly formatted
                      and try again. (Error code: 3008001)

                      * 3008002 - Unable to retrieve workbench summary
                      information. Verify that the specified company exists and
                      that you have permission to access the company's data and
                      try again. (Error code: 3008002)
                    properties:
                      code:
                        type: string
                        example: 3008001
                        enum:
                          - 3008001
                          - 3008002
                      message:
                        type: string
                        example: >-
                          Unable to retrieve workbench summary information.
                          Verify that the request is properly formatted and try
                          again. (Error code: 3008001)
                      innererror:
                        type: object
                        properties:
                          code:
                            type: string
                            example: ''
        '500':
          content:
            application/json:
              schema:
                properties:
                  error:
                    type: object
                    description: >
                      * 3008999: Unable to retrieve workbench summary
                      information. An internal error has occurred. Please try
                      again later. If the issue persists, contact Trend Micro
                      Support. (Error code: 3008999)
                    properties:
                      code:
                        type: string
                        example: 3008999
                        enum:
                          - 3008999
                      message:
                        type: string
                        example: >-
                          Unable to retrieve workbench summary information. An
                          internal error has occurred. Please try again later.
                          If the issue persists, contact Trend Micro Support.
                          (Error code: 3008999)
                      innererror:
                        type: object
                        properties:
                          code:
                            type: string
                            example: ''
      summary: List alerts
      tags:
        - Alerts
      x-code-samples:
        - lang: Python
          source: >-
            import requests

            import json


            url_base = 'https://api.xdr.trendmicro.com'

            url_path = '/v2.0/siem/events'

            token = 'YOUR_TOKEN'


            query_params = {'source': 'YOUR_SOURCE (string)'}

            headers = {'Authorization': 'Bearer ' + token, 'Content-Type':
            'application/json;charset=utf-8'}


            r = requests.get(url_base + url_path, params=query_params,
            headers=headers)


            print(r.status_code)

            if 'application/json' in r.headers.get('Content-Type', ''):
                print(json.dumps(r.json(), indent=4))
            else:
                print(r.text)
  /beta/xdr/portal/products:
    get:
      tags:
        - General
      summary: List supported products
      description: >-
        Retrieves a list of SaaS and on-premises products that XDR supports and
        their corresponding information on the Customer Licensing Platform
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - data
                  - message
                type: object
                properties:
                  code:
                    type: string
                    description: One of a server-defined set of codes
                  message:
                    type: string
                    description: A human-readable representation of the code
                  data:
                    type: array
                    items:
                      required:
                        - licenseStatus
                        - productId
                      type: object
                      properties:
                        isSaaSProduct:
                          type: boolean
                          description: >-
                            true if product is SaaS product , false if product
                            is onpremise Product
                        productId:
                          type: string
                          description: >
                            Device product ID definition:

                            sao:Apex One SaaS,  pao:Apex One On-Prem,  sca:Cloud
                            App Security,  sds:Deep Security SaaS,  pds:Deep
                            Security On-Prem,  pdd:DDD,  sna:DDDNA SaaS, 
                            pei:DDEI,  pdi:DDI
                        connectorStatus:
                          type: integer
                          description: >
                            required if isSaaSProduct is true or produt is DDD.

                            '0: NOT PURCHASED 1: connected 2: not connected'. If
                            produt is DDD, '0: not added 1: added'.
                        licenseStatus:
                          type: integer
                          description: '0: NOT PURCHASED 1: Available'
                        clpAccount:
                          type: array
                          description: CLP account info; required if isSaaSProduct is true
                          items:
                            required:
                              - clpCompanyID
                              - clpHostName
                            type: object
                            properties:
                              clpHostName:
                                type: string
                                description: CLP host name
                              clpCompanyID:
                                type: string
                                description: CLP customer/company ID
        '500':
          description: Internal server error
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        description: |
                          One of a server-defined set of codes
                          * InternalServerError
                          * DbError
                          * DeleteServiceUrlFail
                          * DeleteEMSConfiglFail
                          * DeleteAuthNAPIKeyFail
                          * PushProvisioningTaskFail
                          * GenerateAuthNTokenFail
                          * CLPServiceFail
                          * SESServiceFail
                        default: InternalServerError
                      message:
                        type: string
                        description: A human-readable representation of the code
  /beta/xdr/portal/connectors:
    get:
      tags:
        - General
      summary: List connected products
      description: >-
        Retrieves a list of on-premises and SaaS products that are connected to
        the XDR service platform
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - data
                  - message
                type: object
                properties:
                  code:
                    type: string
                    description: One of a server-defined set of codes
                    default: Success
                  message:
                    type: string
                    description: A human-readable representation of the code
                  data:
                    type: array
                    items:
                      required:
                        - connectorId
                        - connectorType
                        - description
                        - identifier
                        - isConnected
                        - lastConnectedTime
                        - notConnectedReason
                        - productId
                        - token
                        - tokenExpireTime
                      type: object
                      properties:
                        description:
                          type: string
                          description: Description of the connector
                        lastConnectedTime:
                          type: integer
                          description: >-
                            Timestamp of the last connected time of the
                            connector, 0 means the connector is not connected
                        connectorId:
                          type: integer
                          description: ID of the product connector
                        connectorType:
                          type: integer
                          description: >-
                            Type of product connector, 1 for Saas 2 for
                            onpremise
                        isConnected:
                          type: boolean
                          description: The connector is successfully registerd or not
                        notConnectedReason:
                          type: integer
                          description: >-
                            The reason why the connector is not successfully
                            registered CAS_ENABLE_FEATURE_FAIL: 1,
                            CAS_SET_SERVICE_URL_FAIL: 2,
                            EMS_GET_COMMON_LOG_RECEIVER_FROM_SP_FAIL: 3,
                            EMS_CREATE_CONFIGURATION_IN_EMS_FAIL: 4,
                            APO_SET_SERVICE_URL_FAIL: 5,
                            APO_GET_COMPANY_INFO_API_FAIL: 6,
                            APO_NO_REGISTERED_DATA_LAKE: 7,
                            APO_DELETE_SERVICE_URL_FAIL: 8,
                            HDL_PROVISIONING_FAIL: 9, AOC_SET_EDL_FAIL: 10,
                            PUSH_PROVISION_TASK_FAIL: 11, APO_HDL_NOT_FOUND: 12,
                            EPAS_GET_API_KEY_FAIL: 13, AUTH_SET_API_KEY_FAIL:
                            14, APO_SET_APO_SERVICE_URL_FAIL: 15,
                        productId:
                          type: string
                          description: >
                            Device product ID definition:

                            sao:Apex One SaaS,  pao:Apex One On-Prem,  sca:Cloud
                            App Security,  sds:Deep Security SaaS,  pds:Deep
                            Security On-Prem,  pdd:DDD,  sna:DDDNA SaaS, 
                            pei:DDEI,  pdi:DDI,  sem:EMS
                        productSubType:
                          type: integer
                          description: |
                            Device product sub type definition:
                              0: none,
                              For DDD(productId:pdd), 1:onpremise version, 2: cloud version
                        token:
                          type: string
                          description: 'JWT token, it will be '''' if Saas product'
                        tokenExpireTime:
                          type: integer
                          description: >-
                            Expire time of the token, it will be 0 if Saas
                            product
                        identifier:
                          type: string
                          description: >-
                            Identifier for the connector, can be Trend Micro
                            account (Company region)/ Host name (IP address)/
                            SaaS URL (instance id)
                        status:
                          type: integer
                          description: |
                            Connector status definition:
                              0: None,
                              1: Connected,
                              2: Pending,
                              3: Provisioning,
                              4: TokenExpired,
                              5: LastConnected,
                              6: NotConnected,
                        subProducts:
                          type: array
                          description: DDD sub product connector info
                          items:
                            required:
                              - connectorId
                              - description
                              - identifier
                              - isConnected
                              - lastConnectedTime
                              - notConnectedReason
                              - productId
                              - token
                              - tokenExpireTime
                            type: object
                            properties:
                              description:
                                type: string
                                description: Description of the connector
                              lastConnectedTime:
                                type: integer
                                description: >-
                                  Timestamp of the last connected time of the
                                  connector, 0 means the connector is not
                                  connected
                              connectorId:
                                type: integer
                                description: ID of the product connector
                              connectorType:
                                type: integer
                                description: >-
                                  Type of product connector, 1 for Saas 2 for
                                  onpremise
                              isConnected:
                                type: boolean
                                description: The connector is successfully registerd or not
                              notConnectedReason:
                                type: integer
                                description: >-
                                  The reason why the connector is not
                                  successfully registered
                                  CAS_ENABLE_FEATURE_FAIL: 1,
                                  CAS_SET_SERVICE_URL_FAIL: 2,
                                  EMS_GET_COMMON_LOG_RECEIVER_FROM_SP_FAIL: 3,
                                  EMS_CREATE_CONFIGURATION_IN_EMS_FAIL: 4,
                                  APO_SET_SERVICE_URL_FAIL: 5,
                                  APO_GET_COMPANY_INFO_API_FAIL: 6,
                                  APO_NO_REGISTERED_DATA_LAKE: 7,
                                  APO_DELETE_SERVICE_URL_FAIL: 8,
                                  HDL_PROVISIONING_FAIL: 9, AOC_SET_EDL_FAIL:
                                  10, PUSH_PROVISION_TASK_FAIL: 11,
                                  APO_HDL_NOT_FOUND: 12, EPAS_GET_API_KEY_FAIL:
                                  13, AUTH_SET_API_KEY_FAIL: 14,
                                  APO_SET_APO_SERVICE_URL_FAIL: 15,
                              productId:
                                type: string
                                description: >
                                  Device product ID definition:

                                  sao:Apex One SaaS,  pao:Apex One On-Prem, 
                                  sca:Cloud App Security,  sds:Deep Security
                                  SaaS,  pds:Deep Security On-Prem,  pdd:DDD, 
                                  sna:DDDNA SaaS,  pei:DDEI,  pdi:DDI,  sem:EMS
                              token:
                                type: string
                                description: 'JWT token, if '''' means token expired'
                              tokenExpireTime:
                                type: integer
                                description: Expire time of the token
                              identifier:
                                type: string
                                description: >-
                                  Identifier for the connector, , can be Trend
                                  Micro account (Company region)/ Host name (IP
                                  address)/ SaaS URL (instance id)
                              status:
                                type: integer
                                description: |
                                  Connector status definition:
                                    0: None,
                                    1: Connected,
                                    2: Pending,
                                    3: Provisioning,
                                    4: TokenExpired,
                                    5: LastConnected,
                                    6: NotConnected,
        '500':
          description: Internal server error
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        description: |
                          One of a server-defined set of codes
                          * InternalServerError
                          * DbError
                          * DeleteServiceUrlFail
                          * DeleteEMSConfiglFail
                          * DeleteAuthNAPIKeyFail
                          * PushProvisioningTaskFail
                          * GenerateAuthNTokenFail
                          * CLPServiceFail
                          * SESServiceFail
                        default: InternalServerError
                      message:
                        type: string
                        description: A human-readable representation of the code
  /v1.0/xdr/portal/connectors/saas:
    get: &ref_2
      tags:
        - SaaS
      summary: List supported SaaS products
      description: >-
        Retrieves a list of SaaS products that XDR supports and their
        corresponding information on the Customer Licensing Platform
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - data
                  - message
                type: object
                properties:
                  code:
                    type: string
                    description: One of a server-defined set of codes
                  message:
                    type: string
                    description: A human-readable representation of the code
                  data:
                    type: array
                    items:
                      required:
                        - productId
                      type: object
                      properties:
                        productId:
                          type: string
                          description: >
                            Device product ID definition:

                            sao:Apex One SaaS,  pao:Apex One On-Prem,  sca:Cloud
                            App Security,  sds:Deep Security SaaS,  pds:Deep
                            Security On-Prem,  pdd:DDD,  sna:DDDNA SaaS, 
                            pei:DDEI,  pdi:DDI
                        connectorStatus:
                          type: integer
                          description: '0: NOT PURCHASED 1: connected 2: not connected'
                        clpAccount:
                          type: array
                          description: CLP account info
                          items:
                            required:
                              - clpCompanyID
                              - clpHostName
                            type: object
                            properties:
                              clpHostName:
                                type: string
                                description: CLP host name
                              clpCompanyID:
                                type: string
                                description: CLP customer/company ID
        '500':
          description: Internal server error
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        description: |
                          One of a server-defined set of codes
                          * InternalServerError
                          * DbError
                          * DeleteServiceUrlFail
                          * DeleteEMSConfiglFail
                          * DeleteAuthNAPIKeyFail
                          * PushProvisioningTaskFail
                          * GenerateAuthNTokenFail
                          * CLPServiceFail
                          * SESServiceFail
                        default: InternalServerError
                      message:
                        type: string
                        description: A human-readable representation of the code
    post: &ref_3
      tags:
        - SaaS
      summary: Connect SaaS product
      description: Connects a SaaS product to the XDR service platform
      requestBody:
        content:
          application/json:
            schema:
              required:
                - clpCompanyID
                - clpHostName
                - description
                - productId
              type: object
              properties:
                productId:
                  type: string
                  description: >
                    Device product ID definition:

                    sao:Apex One SaaS,  pao:Apex One On-Prem,  sca:Cloud App
                    Security,  sds:Deep Security SaaS,  pds:Deep Security
                    On-Prem,  pdd:DDD,  sna:DDDNA SaaS,  pei:DDEI,  pdi:DDI, 
                    sem:EMS
                description:
                  type: string
                  description: Description of the connector
                clpHostName:
                  type: string
                  description: CLP host name
                clpCompanyID:
                  type: string
                  description: CLP customer/company ID
        required: false
      responses:
        '200':
          description: Successful operation
          content:
            '*/*':
              schema:
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    description: A human-readable representation of the code
                  data:
                    type: object
                    properties: {}
                    description: 'Response data, optional, JSON object'
        '400':
          description: Invalid parameters
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
                        description: A human-readable representation of the code
        '500':
          description: Internal server error
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        description: |
                          One of a server-defined set of codes
                          * InternalServerError
                          * DbError
                          * DeleteServiceUrlFail
                          * DeleteEMSConfiglFail
                          * DeleteAuthNAPIKeyFail
                          * PushProvisioningTaskFail
                          * GenerateAuthNTokenFail
                          * CLPServiceFail
                          * SESServiceFail
                        default: InternalServerError
                      message:
                        type: string
                        description: A human-readable representation of the code
      x-codegen-request-body-name: root
  /beta/xdr/portal/connectors/saas:
    get: *ref_2
    post: *ref_3
  /beta/xdr/portal/connectors/saas/reconnect:
    post:
      tags:
        - SaaS
      summary: Retry connecting SaaS product
      description: >-
        Connects a SaaS product to the XDR service platform after an
        unsuccessful connection attempt
      requestBody:
        content:
          application/json:
            schema:
              required:
                - productId
                - connectorId
              type: object
              properties:
                productId:
                  type: string
                  description: |
                    Device product ID definition:
                    sao:Apex One SaaS,  sca:Cloud App Security
                connectorId:
                  type: integer
                  description: ID of the product connector
        required: false
      responses:
        '200':
          description: Successful operation
          content:
            '*/*':
              schema:
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    description: A human-readable representation of the code
                  data:
                    type: object
                    properties: {}
                    description: 'Response data, optional, JSON object'
        '400':
          description: Invalid parameters
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
                        description: A human-readable representation of the code
        '500':
          description: Internal server error
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        description: |
                          One of a server-defined set of codes
                          * InternalServerError
                          * DbError
                          * DeleteServiceUrlFail
                          * DeleteEMSConfiglFail
                          * DeleteAuthNAPIKeyFail
                          * PushProvisioningTaskFail
                          * GenerateAuthNTokenFail
                          * CLPServiceFail
                          * SESServiceFail
                        default: InternalServerError
                      message:
                        type: string
                        description: A human-readable representation of the code
      x-codegen-request-body-name: root
  /beta/xdr/portal/connectors/checkCASAuth:
    get:
      tags:
        - General
      summary: Check CAS authorization status
      description: Check authorization status for connected CAS products
      responses:
        '200':
          description: Successful operation
          content:
            '*/*':
              schema:
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    description: A human-readable representation of the code
                  data:
                    type: object
                    properties:
                      status:
                        type: integer
                        description: >-
                          CAS products new authorization status, 0 for "still
                          unauthorized", 1 for "authorized"
        '500':
          description: Internal server error
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        description: |
                          One of a server-defined set of codes
                          * InternalServerError
                          * DbError
                          * DeleteServiceUrlFail
                          * DeleteEMSConfiglFail
                          * DeleteAuthNAPIKeyFail
                          * PushProvisioningTaskFail
                          * GenerateAuthNTokenFail
                          * CLPServiceFail
                          * SESServiceFail
                        default: InternalServerError
                      message:
                        type: string
                        description: A human-readable representation of the code
      x-codegen-request-body-name: root
  '/v1.0/xdr/portal/connectors/saas/{id}':
    delete: &ref_4
      tags:
        - SaaS
      summary: Disconnect SaaS product
      description: Disconnects a SaaS product from the XDR service platform
      parameters:
        - name: id
          in: path
          description: ID of the product connector
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful operation
          content:
            '*/*':
              schema:
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    description: A human-readable representation of the code
                  data:
                    type: object
                    properties: {}
                    description: 'Response data, optional, JSON object'
        '400':
          description: Invalid parameters
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
                        description: A human-readable representation of the code
        '500':
          description: Internal server error
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        description: |
                          One of a server-defined set of codes
                          * InternalServerError
                          * DbError
                          * DeleteServiceUrlFail
                          * DeleteEMSConfiglFail
                          * DeleteAuthNAPIKeyFail
                          * PushProvisioningTaskFail
                          * GenerateAuthNTokenFail
                          * CLPServiceFail
                          * SESServiceFail
                        default: InternalServerError
                      message:
                        type: string
                        description: A human-readable representation of the code
    patch: &ref_5
      tags:
        - SaaS
      summary: Edit SaaS product description
      description: >-
        Modifies the description of a SaaS product that is connected to the  XDR
        service platform
      parameters:
        - name: id
          in: path
          description: ID of the product connector
          required: true
          schema:
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              required:
                - description
              type: object
              properties:
                description:
                  type: string
                  description: Description of the product connector
        required: false
      responses:
        '200':
          description: Successful operation
          content:
            '*/*':
              schema:
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    description: A human-readable representation of the code
                  data:
                    type: object
                    properties: {}
                    description: 'Response data, optional, JSON object'
        '400':
          description: Invalid parameters
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
                        description: A human-readable representation of the code
        '500':
          description: Internal server error
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        description: |
                          One of a server-defined set of codes
                          * InternalServerError
                          * DbError
                          * DeleteServiceUrlFail
                          * DeleteEMSConfiglFail
                          * DeleteAuthNAPIKeyFail
                          * PushProvisioningTaskFail
                          * GenerateAuthNTokenFail
                          * CLPServiceFail
                          * SESServiceFail
                        default: InternalServerError
                      message:
                        type: string
                        description: A human-readable representation of the code
      x-codegen-request-body-name: body
  '/beta/xdr/portal/connectors/saas/{id}':
    delete: *ref_4
    patch: *ref_5
  /beta/xdr/portal/connectors/onpremise/token:
    post:
      tags:
        - On-premises
      summary: Generate enrollment token
      description: Generates an enrollment token for an on-premises product
      requestBody:
        content:
          application/json:
            schema:
              required:
                - productId
              type: object
              properties:
                productId:
                  type: string
                action:
                  type: string
                  description: add or edit
                connectorId:
                  type: string
                  description: Required if action == 'edit'
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - data
                  - message
                type: object
                properties:
                  code:
                    type: string
                    description: One of a server-defined set of codes
                  message:
                    type: string
                    description: A human-readable representation of the code
                  data:
                    required:
                      - token
                    type: object
                    properties:
                      token:
                        type: string
                      tokenExpireTime:
                        type: integer
                      connectorId:
                        type: integer
        '500':
          description: Internal server error
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        description: |
                          One of a server-defined set of codes
                          * InternalServerError
                          * DbError
                          * DeleteServiceUrlFail
                          * DeleteEMSConfiglFail
                          * DeleteAuthNAPIKeyFail
                          * PushProvisioningTaskFail
                          * GenerateAuthNTokenFail
                          * CLPServiceFail
                          * SESServiceFail
                        default: InternalServerError
                      message:
                        type: string
                        description: A human-readable representation of the code
  /beta/xdr/portal/connectors/onpremise:
    get:
      tags:
        - On-premises
      summary: List supported on-premises products
      description: >-
        Retrieves a list of on-premises products that XDR supports and their
        corresponding information on the Customer Licensing Platform
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - data
                  - message
                type: object
                properties:
                  code:
                    type: string
                    description: One of a server-defined set of codes
                  message:
                    type: string
                    description: A human-readable representation of the code
                  data:
                    type: array
                    items:
                      required:
                        - licenseStatus
                        - productId
                      type: object
                      properties:
                        productId:
                          type: string
                          description: >
                            Device product ID definition:

                            pao:Apex One On-Prem, pds:Deep Security On-Prem, 
                            pdd:DDD
                        licenseStatus:
                          type: integer
                          description: '0: NOT PURCHASED 1: Available'
        '500':
          description: Internal server error
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        description: |
                          One of a server-defined set of codes
                          * InternalServerError
                          * DbError
                          * DeleteServiceUrlFail
                          * DeleteEMSConfiglFail
                          * DeleteAuthNAPIKeyFail
                          * PushProvisioningTaskFail
                          * GenerateAuthNTokenFail
                          * CLPServiceFail
                          * SESServiceFail
                        default: InternalServerError
                      message:
                        type: string
                        description: A human-readable representation of the code
    post:
      tags:
        - On-premises
      summary: Connects an on-premises product to the XDR console
      description: Connects an on-premises product to the XDR service platform
      requestBody:
        content:
          application/json:
            schema:
              required:
                - description
                - productType
              type: object
              properties:
                productType:
                  type: string
                  description: >
                    Device product type definition:

                    DEEP_DISCOVERY_DIRECTOR: 21, APEX_ONE_ON_PREM:
                    23,Deep_Security_SaaS: 24, Deep_Security_On_Prem: 25
                description:
                  type: string
                  description: Description of the connector
                connectorId:
                  type: integer
                  description: >-
                    id of the connector which is created when generate
                    token,required if productType is sds or pdd(productSubType
                    must be 1)
                productSubType:
                  type: integer
                  description: >-
                    0 - none , 1 - DDD onpremise ,2 - DDD cloud . required if
                    productType is pdd
                activationCode:
                  type: string
                  description: >-
                    activation code for products like DDD on AWS. required if
                    productType is 21.
        required: false
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - data
                  - message
                type: object
                properties:
                  code:
                    type: string
                    description: One of a server-defined set of codes
                  message:
                    type: string
                    description: A human-readable representation of the code
                  data:
                    type: object
                    properties:
                      connectorId:
                        type: integer
                        description: ID of the product connector
        '500':
          description: Internal server error
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        description: |
                          One of a server-defined set of codes
                          * InternalServerError
                          * DbError
                          * DeleteServiceUrlFail
                          * DeleteEMSConfiglFail
                          * DeleteAuthNAPIKeyFail
                          * PushProvisioningTaskFail
                          * GenerateAuthNTokenFail
                          * CLPServiceFail
                          * SESServiceFail
                        default: InternalServerError
                      message:
                        type: string
                        description: A human-readable representation of the code
      x-codegen-request-body-name: root
  '/v1.0/xdr/portal/connectors/onpremise/{id}':
    delete: &ref_6
      tags:
        - On-premises
      summary: Disconnect on-premises product
      description: Disconnects an on-premises product from the XDR service platform
      parameters:
        - name: id
          in: path
          description: ID of the product connector
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful operation
          content:
            '*/*':
              schema:
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    description: A human-readable representation of the code
                  data:
                    type: object
                    properties: {}
                    description: 'Response data, optional, JSON object'
        '400':
          description: Invalid parameters
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
                        description: A human-readable representation of the code
        '500':
          description: Internal server error
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        description: |
                          One of a server-defined set of codes
                          * InternalServerError
                          * DbError
                          * DeleteServiceUrlFail
                          * DeleteEMSConfiglFail
                          * DeleteAuthNAPIKeyFail
                          * PushProvisioningTaskFail
                          * GenerateAuthNTokenFail
                          * CLPServiceFail
                          * SESServiceFail
                        default: InternalServerError
                      message:
                        type: string
                        description: A human-readable representation of the code
    patch: &ref_7
      tags:
        - On-premises
      summary: Edit description of on-premises product
      description: >-
        Modifies the description of an on-premises product that is connected to
        the XDR service platform
      parameters:
        - name: id
          in: path
          description: ID of the product connector
          required: true
          schema:
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              required:
                - description
              type: object
              properties:
                description:
                  type: string
                  description: Description of the product connector
        required: false
      responses:
        '200':
          description: Successful operation
          content:
            '*/*':
              schema:
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    description: A human-readable representation of the code
                  data:
                    type: object
                    properties: {}
                    description: 'Response data, optional, JSON object'
        '400':
          description: Invalid parameters
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
                        description: A human-readable representation of the code
        '500':
          description: Internal server error
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        description: |
                          One of a server-defined set of codes
                          * InternalServerError
                          * DbError
                          * DeleteServiceUrlFail
                          * DeleteEMSConfiglFail
                          * DeleteAuthNAPIKeyFail
                          * PushProvisioningTaskFail
                          * GenerateAuthNTokenFail
                          * CLPServiceFail
                          * SESServiceFail
                        default: InternalServerError
                      message:
                        type: string
                        description: A human-readable representation of the code
      x-codegen-request-body-name: body
  '/beta/xdr/portal/connectors/onpremise/{id}':
    delete: *ref_6
    patch: *ref_7
  /beta/xdr/portal/notifications/alerts:
    get:
      tags:
        - Notifications
      summary: Get alert notification settings
      description: Retrieves the settings for Splunk Alerts and email notifications
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                  - data
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
                  data:
                    type: object
                    properties:
                      email:
                        type: string
                    required:
                      - email
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
    put:
      tags:
        - Notification Center
      summary: Edit alert notification settings
      description: Modifies the settings for Splunk Alerts and email notifications
      requestBody:
        content:
          application/json:
            schema:
              title: empty object
              type: object
              properties:
                email:
                  type: string
              required:
                - email
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
  /v1.0/xdr/portal/notifications/alerts/sendEmails:
    post: &ref_8
      tags:
        - Notifications
      summary: Send test email notification
      description: Sends a test notification to the specified email address address
      requestBody:
        content:
          application/json:
            schema:
              title: empty object
              type: object
              properties:
                email:
                  type: string
              required:
                - email
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
  /beta/xdr/portal/notifications/alerts/sendEmails:
    post: *ref_8
  /beta/xdr/portal/accounts:
    get:
      tags:
        - Accounts
      summary: List accounts
      description: >-
        Retrieves a list of SAML and local accounts with access to the XDR
        service platform
      parameters:
        - name: pageIndex
          in: query
          description: >
            The page index of user accounts returned in paginated output. This
            value can be greater than or equal to 1. If you don't use this
            parameter, ListAccounts returns results of the first page.
          schema:
            minimum: 1
            type: integer
            format: int32
            default: 1
        - name: pageSize
          in: query
          description: >
            The maximum number of user accounts returned in paginated output.
            This value can be 50, 100 or 200. If you don\'t use this parameter,
            ListAccounts returns up to 50 results.
          schema:
            type: integer
            format: int32
            default: 50
            enum:
              - 50
              - 100
              - 200
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - data
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
                  data:
                    type: object
                    properties:
                      totalCounts:
                        type: integer
                      items:
                        type: array
                        items:
                          required:
                            - authorization
                            - description
                            - enabled
                            - name
                            - role
                            - token
                            - type
                            - verificationOverdueTime
                          type: object
                          properties:
                            type:
                              type: integer
                              description: |
                                The type of user account.
                                * 0 - Custom account
                                * 1 - AD account
                            name:
                              type: string
                            email:
                              type: string
                              description: |
                                The user account email.
                            enabled:
                              type: boolean
                            description:
                              type: string
                            authorization:
                              type: integer
                              description: |
                                * 1 - XDR console only
                                * 2 - APIs only
                                * 3 - XDR console and APIs
                            role:
                              type: string
                            token:
                              type: string
                              description: >
                                When the user accesses api of service platform,
                                the token is used to authenticate.
                            verificationOverdueTime:
                              type: integer
                              description: >
                                if the user account is an unvarified local
                                account, this value will be timestamp in seconds
                                when the verification link is expired . If the
                                user account is an AD account or a varified
                                local account, the value will be 0.
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
  '/beta/xdr/portal/accounts/{email}':
    put:
      tags:
        - Accounts
      summary: Edit account settings
      description: Modifies the settings of a SAML or local account
      parameters:
        - name: email
          in: path
          description: The parameter should be url encoded
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              title: empty object
              type: object
              properties:
                type:
                  type: integer
                  description: |
                    The type of user account.
                    * 0 - Custom account
                    * 1 - AD account
                enabled:
                  type: boolean
                description:
                  type: string
                token:
                  type: string
                password:
                  type: string
                authorization:
                  type: integer
                  description: |
                    * 1 - XDR console only
                    * 2 - APIs only
                    * 3 - XDR console and APIs
                role:
                  type: string
        required: false
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
      x-codegen-request-body-name: root
    post: &ref_9
      tags:
        - Account
      summary: Create account
      description: Creates a SAML or local account
      parameters:
        - name: email
          in: path
          description: The parameter should be url encoded.
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              title: empty object
              type: object
              properties:
                type:
                  type: integer
                  description: |
                    The type of user account.
                    * 0 - Custom account
                    * 1 - AD account
                name:
                  type: string
                enabled:
                  type: boolean
                description:
                  type: string
                token:
                  type: string
                authorization:
                  type: integer
                  description: |
                    * 1 - XDR console only
                    * 2 - APIs only
                    * 3 - XDR console and APIs
                role:
                  type: string
        required: false
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
      x-codegen-request-body-name: root
    delete: &ref_10
      tags:
        - Account
      summary: Delete account
      description: Deletes an account from the XDR service platform
      parameters:
        - name: email
          in: path
          description: The parameter should be url encoded.
          required: true
          schema:
            type: string
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
  '/v1.0/xdr/portal/accounts/{email}':
    post: *ref_9
    delete: *ref_10
  '/v1.0/xdr/portal/accounts/{email}/tokens':
    get: &ref_11
      tags:
        - API Authentication Token
      summary: Generate authentication token
      description: Generates an authentication token for an account with API access
      parameters:
        - name: email
          in: path
          description: The parameter should be url encoded.
          required: true
          schema:
            type: string
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - data
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
                  data:
                    required:
                      - token
                    type: object
                    properties:
                      token:
                        type: string
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: InvalidParameter
                  message:
                    type: string
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Unauthorized
                  message:
                    type: string
                    default: >-
                      User account has no authorization to access. Please
                      contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content: {}
    delete: &ref_12
      tags:
        - Account
      summary: Delete authentication token
      description: Deletes the authentication token of an account with API access
      parameters:
        - name: email
          in: path
          description: The parameter should be url encoded.
          required: true
          schema:
            type: string
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
  '/beta/xdr/portal/accounts/{email}/tokens':
    get: *ref_11
    delete: *ref_12
  /v1.0/xdr/portal/accounts/roles:
    get: &ref_13
      tags:
        - Roles
      summary: List roles
      description: >-
        Retrieves a list of roles that users can select when configuring
        accounts
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - data
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
                  data:
                    required:
                      - roles
                    type: object
                    properties:
                      roles:
                        type: array
                        items:
                          type: string
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
  /beta/xdr/portal/accounts/roles:
    get: *ref_13
  '/v1.0/xdr/portal/accounts/{email}/passwords':
    put: &ref_14
      tags:
        - Password
      summary: Configure local account password
      description: >-
        Configures the account password using the link in the verification
        message
      parameters:
        - name: email
          in: path
          description: The parameter should be url encoded.
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              title: empty object
              required:
                - password
                - token
              type: object
              properties:
                password:
                  type: string
                token:
                  type: string
                  description: |
                    The token can be extracted from the verification link.
        required: false
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
      x-codegen-request-body-name: root
  '/beta/xdr/portal/accounts/{email}/passwords':
    put: *ref_14
  '/v1.0/xdr/portal/accounts/{email}/passwords/sendEmails':
    post: &ref_15
      tags:
        - Password
      summary: "Send account verification\_message"
      description: >-
        Sends a verification message with a link to a password configuration
        screen
      parameters:
        - name: email
          in: path
          description: The parameter should be url encoded.
          required: true
          schema:
            type: string
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
  '/beta/xdr/portal/accounts/{email}/passwords/sendEmails':
    post: *ref_15
  /v1.0/xdr/portal/accounts/mfa:
    get: &ref_16
      tags:
        - Two-factor Authentication
      summary: Get two-factor authentication status
      description: >-
        Retrieves the status (enabled or disabled) of two-factor authentication
        for local accounts
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
                  data:
                    required:
                      - enabled
                    type: object
                    properties:
                      enabled:
                        type: boolean
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
    put: &ref_17
      tags:
        - Account
      summary: Enable or disable two-factor authentication
      description: Enables or disables two-factor authentication for local accounts
      requestBody:
        content:
          '*/*':
            schema:
              title: empty object
              required:
                - enabled
              type: object
              properties:
                enabled:
                  type: boolean
        required: false
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
      x-codegen-request-body-name: root
  /beta/xdr/portal/accounts/mfa:
    get: *ref_16
    put: *ref_17
  '/v1.0/xdr/portal/accounts/{email}/mfa/sendEmails':
    post: &ref_18
      tags:
        - Two-factor Authentication
      summary: >-
        Send two-factor authentication setup information or emergency access
        code
      description: >-
        Sends two-factor authentication setup information or an emergency access
        code to a specific account
      parameters:
        - name: email
          in: path
          description: The parameter should be url encoded.
          required: true
          schema:
            type: string
      requestBody:
        content:
          '*/*':
            schema:
              title: empty object
              required:
                - isEmergency
                - isSetup
              type: object
              properties:
                isSetup:
                  type: boolean
                  default: true
                isEmergency:
                  type: boolean
                  default: false
        required: false
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
      x-codegen-request-body-name: root
  '/beta/xdr/portal/accounts/{email}/mfa/sendEmails':
    post: *ref_18
  /v1.0/xdr/portal/accounts/mfa/sendEmails:
    post: &ref_19
      tags:
        - Two-factor Authentication
      summary: Send two-factor authentication reset message
      description: >-
        Sends information about resetting two-factor authentication settings to
        a specific account
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
  /beta/xdr/portal/accounts/mfa/sendEmails:
    post: *ref_19
  /beta/xdr/portal/roles:
    get:
      tags:
        - Roles
      summary: List roles used in company accounts
      description: >-
        Retrieves a list of roles used in company accounts and their
        corresponding permissions
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - data
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
                  data:
                    required:
                      - items
                    type: object
                    properties:
                      items:
                        type: array
                        items:
                          type: object
                          properties:
                            role:
                              type: string
                            permissions:
                              type: object
                              description: >-
                                Indicate whether the user account with this role
                                has permission to access the api. 

                                * 0 - No access 

                                * 1 - Full access
                            description:
                              type: string
                            lastUpdateTime:
                              type: integer
                            accounts:
                              type: array
                              items:
                                type: object
                                properties:
                                  name:
                                    type: string
                                  email:
                                    type: string
                                  type:
                                    type: integer
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
  '/beta/xdr/portal/roles/{role}/permissions':
    get:
      tags:
        - Roles
      summary: Get permissions of a specific role
      description: Retrieves the permissions of a specific role for all XDR features
      parameters:
        - name: role
          in: path
          description: The parameter should be url encoded.
          required: true
          schema:
            type: string
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - data
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
                  data:
                    required:
                      - permissions
                    type: object
                    properties:
                      permissions:
                        type: object
                        description: >-
                          Indicate whether the user account with this role has
                          permission to access the api. 

                          * 0 - No access 

                          * 1 - Full access
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
  /beta/xdr/portal/roles/permissions:
    get:
      tags:
        - Roles
      summary: Get permissions of all roles
      description: Retrieves the permissions of all roles for all XDR features features
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - data
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
                  data:
                    type: array
                    items:
                      required:
                        - permissions
                        - role
                      type: object
                      properties:
                        role:
                          type: string
                        permissions:
                          type: object
                          description: >-
                            Indicate whether the user account with this role has
                            permission to access the api. 

                            * 0 - No access 

                            * 1 - Full access
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
  /v1.0/xdr/portal/metadata/xdrSpMetadata.xml:
    get: &ref_20
      tags:
        - SAML
      summary: Download Trend Micro XDR service provider (SP) metadata file
      description: >-
        Downloads the Trend Micro XDR service provider (SP) metadata file
        required for SAML 2.0 single sign-on configuration
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                type: string
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
  /beta/xdr/portal/metadata/xdrSpMetadata.xml:
    get: *ref_20
  /v1.0/xdr/portal/metadata:
    put: &ref_21
      tags:
        - SAML
      summary: Upload IdP metadata file
      description: >-
        Uploads the IdP metadata file required for SAML 2.0 single sign-on
        configuration
      requestBody:
        content:
          '*/*':
            schema:
              title: empty object
              required:
                - metadata
              type: object
              properties:
                metadata:
                  type: string
                name:
                  type: string
        required: false
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
      x-codegen-request-body-name: root
  /beta/xdr/portal/metadata:
    put: *ref_21
    get:
      tags:
        - Single Sign-On
      summary: Get IdP metadata file attributes
      description: Retrieves IdP metadata file attributes such as name and size
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                  - data
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
                  data:
                    type: object
                    properties:
                      name:
                        type: string
                      size:
                        type: string
                    required:
                      - name
                      - size
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
      x-codegen-request-body-name: root
  /v1.0/xdr/portal/metadata/status:
    get: &ref_22
      tags:
        - SAML
      summary: Get single sign-on status
      description: >-
        Retrieves the status (enabled or disabled) of single sign-on for SAML
        accounts
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - data
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
                  data:
                    required:
                      - enabled
                    type: object
                    properties:
                      enabled:
                        type: boolean
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
    put: &ref_23
      tags:
        - Single Sign-On
      summary: Enable or disable single sign-on
      description: Enables or disables single sign-on for SAML accounts
      requestBody:
        content:
          '*/*':
            schema:
              title: empty object
              required:
                - enabled
              type: object
              properties:
                enabled:
                  type: boolean
        required: false
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Success
        '400':
          description: >-
            The specified parameter is invalid. Review the available parameters
            for the API request.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InvalidParameter
                      message:
                        type: string
        '401':
          description: User account failed to pass the authentication of the server.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account Failed to authenticate with the server.
                          Please contact your system administrator.
        '403':
          description: >-
            User account tries to access resources which he does not have
            permissions.
          content:
            '*/*':
              schema:
                title: empty object
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: Unauthorized
                      message:
                        type: string
                        default: >-
                          User account has no authorization to access. Please
                          contact your system administrator.
        '500':
          description: These errors are usually caused by a server-side issue.
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        default: InternalServerError
                      message:
                        type: string
                        default: >-
                          An internal error has occurred. Please contact Trend
                          Micro Support.
      x-codegen-request-body-name: root
  /beta/xdr/portal/metadata/status:
    get: *ref_22
    put: *ref_23
  /v1.0/xdr/portal/siem:
    get: &ref_24
      tags:
        - Splunk
      summary: Get Splunk connector information
      description: Retrieves information used to configure the Splunk connector
      parameters: []
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - data
                  - message
                type: object
                properties:
                  code:
                    type: string
                    default: Success
                  message:
                    type: string
                    default: Operation success
                  data:
                    required:
                      - authenticationToken
                      - endpointUrl
                    type: object
                    properties:
                      endpointUrl:
                        type: string
                      authenticationToken:
                        type: string
  /beta/xdr/portal/siem:
    get: *ref_24
  /beta/xdr/portal/auditLog/search:
    get:
      tags:
        - Audit Logs
      summary: Search audit logs
      description: Retrieves a list of log entries that match specified criteria criteria
      parameters:
        - name: pageIndex
          in: query
          description: |
            Page index of audit log query result in paginated format
          schema:
            minimum: 1
            type: integer
            format: int32
            default: 1
        - name: pageSize
          in: query
          description: |
            Number of audit log returned in each page
          schema:
            type: integer
            format: int32
            default: 20
        - name: period
          in: query
          description: Filter log from 30/90/120/180 days ago
          required: true
          schema:
            type: integer
        - name: accessType
          in: query
          description: |
            Filter log for certain access type
            * 0 - Console
            * 1 - API
            * 9 - All
          required: true
          schema:
            type: integer
        - name: categories
          in: query
          description: >
            Filter log for certain categories, format "01|02|03", categories
            definition is as following

            * 01 - Logon

            * 02 - Single Sign-On

            * 03 - Account Management

            * 04 - Product Connector

            * 05 - SIEM Connector

            * 06 - Detection Model Management

            * 07 - Workbench

            * 08 - Response

            * 09 - Search
          required: true
          schema:
            type: string
        - name: detail
          in: query
          description: Filter for log username/code/details info
          required: true
          schema:
            type: string
        - name: sort
          in: query
          description: |
            Sort log ASC or DESC, default is DESC
            * asc - sort by ASC
            * desc - sort by DESC
          schema:
            type: string
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                required:
                  - code
                  - data
                  - message
                type: object
                properties:
                  code:
                    type: string
                    description: One of a server-defined set of codes
                    default: Success
                  message:
                    type: string
                    description: A human-readable representation of the code
                  data:
                    required:
                      - items
                      - totalCounts
                    type: object
                    properties:
                      totalCounts:
                        type: integer
                        description: Total counts of query results by the filters
                      items:
                        type: array
                        items:
                          required:
                            - access
                            - activity
                            - category
                            - details
                            - result
                            - role
                            - user
                          type: object
                          properties:
                            loggedTime:
                              type: string
                              description: The operation time
                              format: dataTime
                            user:
                              type: string
                              description: The logged user name
                            role:
                              type: string
                              description: Role type of the logged user
                            access:
                              type: number
                              description: |
                                Access source definition
                                * 0 - Console
                                * 1 - API
                            category:
                              type: string
                              description: |
                                Category definition code
                                * 01 - Logon
                                * 02 - Single Sign-On
                                * 03 - Account Management
                                * 04 - Product Connector
                                * 05 - SIEM Connector
                                * 06 - Detection Model Management
                                * 07 - Workbench
                                * 08 - Response
                                * 09 - Search
                            activity:
                              type: string
                              description: >
                                Actiivity definition code based on category code

                                Category 01

                                * 01 - Log on

                                * 02 - Log off

                                ref to
                                https://wiki.jarvis.trendmicro.com/display/SG/sLog+for+Customer+Auditing
                            result:
                              type: boolean
                              description: |
                                Operation result
                                * true - Success
                                * false - Failed
                            details:
                              type: object
                              properties: {}
                              description: >
                                Audit log detail info, json format, key can be
                                the as following

                                * ipAddr - IP address

                                * user - User account

                                * role - Role

                                * accessLevel - Access level

                                * product - Product

                                * tmAccount - Trend Micro account

                                * hostName - Host name

                                * modelName - Model name

                                * wbName - Workbench name

                                * status - Status

                                * fileName - File name

                                * messageId - Message ID

                                * mailbox - Mailbox

                                * packageId - Package ID

                                * domain - Domain

                                * url - URL 

                                * port - Port

                                * sha1 - Sha1
        '500':
          description: Internal server error
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        description: |
                          One of a server-defined set of codes
                          * InternalServerError
                          * DbError
                          * DeleteServiceUrlFail
                          * DeleteEMSConfiglFail
                          * DeleteAuthNAPIKeyFail
                          * PushProvisioningTaskFail
                          * GenerateAuthNTokenFail
                          * CLPServiceFail
                          * SESServiceFail
                        default: InternalServerError
                      message:
                        type: string
                        description: A human-readable representation of the code
  /beta/xdr/portal/auditLog/exportCsv:
    get:
      tags:
        - Audit Logs
      summary: Export audit logs
      description: Export log entries that match specified criteria
      parameters:
        - name: pageIndex
          in: query
          description: |
            Page index of audit log query result in paginated format
          schema:
            minimum: 1
            type: integer
            format: int32
            default: 1
        - name: pageSize
          in: query
          description: |
            Number of audit log returned in each page
          schema:
            type: integer
            format: int32
            default: 20
        - name: period
          in: query
          description: Filter log from 30/90/120/180 days ago
          required: true
          schema:
            type: integer
        - name: accessType
          in: query
          description: |
            Filter log for certain access type
            * 0 - Console
            * 1 - API
            * 9 - All
          required: true
          schema:
            type: integer
        - name: categories
          in: query
          description: >
            Filter log for certain categories, format "01|02|03", categories
            definition is as following

            * 01 - Logon

            * 02 - Single Sign-On

            * 03 - Account Management

            * 04 - Product Connector

            * 05 - SIEM Connector

            * 06 - Detection Model Management

            * 07 - Workbench

            * 08 - Response

            * 09 - Search
          required: true
          schema:
            type: string
        - name: detail
          in: query
          description: Filter for log username/code/details info
          required: true
          schema:
            type: string
        - name: sort
          in: query
          description: |
            Sort log ASC or DESC, default is DESC
            * asc - sort by ASC
            * desc - sort by DESC
          schema:
            type: string
      responses:
        '200':
          description: successful operation
          content:
            text/csv:
              schema:
                type: string
                description: csv data.
        '500':
          description: Internal server error
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        description: |
                          One of a server-defined set of codes
                          * InternalServerError
                          * DbError
                          * DeleteServiceUrlFail
                          * DeleteEMSConfiglFail
                          * DeleteAuthNAPIKeyFail
                          * PushProvisioningTaskFail
                          * GenerateAuthNTokenFail
                          * CLPServiceFail
                          * SESServiceFail
                        default: InternalServerError
                      message:
                        type: string
                        description: A human-readable representation of the code
  /beta/xdr/portal/remoteSupport:
    get:
      tags:
        - Remote Support
      summary: Get remote support status
      description: Retrieve the status (enabled or disabled) of remote support
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - data
                  - message
                type: object
                properties:
                  code:
                    type: string
                    example: Success
                    default: Success
                  message:
                    type: string
                    example: Operation success
                    default: Operation success
                  data:
                    required:
                      - enabled
                    type: object
                    properties:
                      enabled:
                        type: boolean
                        default: false
        '500':
          description: Internal server error
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        description: |
                          One of a server-defined set of codes
                          * InternalServerError
                          * GetCompanyIdFail
                        default: InternalServerError
                      message:
                        type: string
                        description: A human-readable representation of the code
    put:
      tags:
        - Remote Support
      summary: Enable remote support
      description: >-
        Allows Trend Micro support engineers to access the XDR console for
        troubleshooting and debug log collection
      requestBody:
        content:
          '*/*':
            schema:
              title: empty object
              required:
                - enabled
              type: object
              properties:
                enabled:
                  type: boolean
        required: true
      responses:
        '200':
          description: successful operation
          content:
            '*/*':
              schema:
                title: empty object
                required:
                  - code
                  - message
                type: object
                properties:
                  code:
                    type: string
                    example: Success
                    default: Success
                  message:
                    type: string
                    example: Operation success
                    default: Operation success
        '500':
          description: Internal server error
          content:
            '*/*':
              schema:
                required:
                  - error
                type: object
                properties:
                  error:
                    required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                        description: |
                          One of a server-defined set of codes
                          * InternalServerError
                          * GetCompanyIdFail
                          * DbError
                          * InvalidParameter
                        default: InternalServerError
                      message:
                        type: string
                        description: A human-readable representation of the code
